"use strict";(self.webpackChunkink_docs=self.webpackChunkink_docs||[]).push([[9097],{43041:(e,n,t)=>{t.d(n,{A:()=>r});const r=t.p+"assets/images/cross-contract-7b46505ded2e3cdbc224075cf758f15a.svg"},65404:(e,n,t)=>{t.d(n,{R:()=>l,x:()=>i});var r=t(36672);const c={},s=r.createContext(c);function l(e){const n=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:l(e.components),r.createElement(s.Provider,{value:n},e.children)}},77873:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>i,default:()=>h,frontMatter:()=>l,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"basics/cross-contract-calling","title":"Cross-Contract Calling","description":"Cross Contract Title Picture","source":"@site/docs/basics/cross-contract-calling.md","sourceDirName":"basics","slug":"/basics/cross-contract-calling","permalink":"/docs/v6/basics/cross-contract-calling","draft":false,"unlisted":false,"editUrl":"https://github.com/use-ink/ink-docs/edit/master/docs/basics/cross-contract-calling.md","tags":[],"version":"current","frontMatter":{"title":"Cross-Contract Calling","slug":"/basics/cross-contract-calling","hide_title":true},"sidebar":"reference","previous":{"title":"Gas","permalink":"/docs/v6/basics/gas"},"next":{"title":"Selectors","permalink":"/docs/v6/basics/selectors"}}');var c=t(23420),s=t(65404);const l={title:"Cross-Contract Calling",slug:"/basics/cross-contract-calling",hide_title:!0},i="Cross-Contract Calls",a={},o=[{value:"Contract References",id:"contract-references",level:2},{value:"Statically generated contract references",id:"statically-generated-contract-references",level:3},{value:"<strong>CrossContractCalls walkthrough</strong>",id:"crosscontractcalls-walkthrough",level:4},{value:"<strong>Importing <code>OtherContract</code></strong>",id:"importing-othercontract",level:4},{value:"<strong>Wiring <code>CrossContractCalls</code></strong>",id:"wiring-crosscontractcalls",level:4},{value:"<strong>Instantiating <code>CrossContractCalls</code> with an address for <code>OtherContract</code></strong>",id:"instantiating-crosscontractcalls-with-an-address-for-othercontract",level:4},{value:"<strong>Calling <code>OtherContract</code> through <code>CrossContractCalls</code></strong>",id:"calling-othercontract-through-crosscontractcalls",level:4},{value:"Manually defined contract references",id:"manually-defined-contract-references",level:3},{value:"Builders",id:"builders",level:2},{value:"CreateBuilder",id:"createbuilder",level:3},{value:"CallBuilder",id:"callbuilder",level:3},{value:"<strong>CallBuilder: Call</strong>",id:"callbuilder-call",level:4},{value:"<strong>CallBuilder: Delegate Call</strong>",id:"callbuilder-delegate-call",level:4},{value:"Builder Error Handling",id:"builder-error-handling",level:3}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n.p,{children:(0,c.jsx)(n.img,{alt:"Cross Contract Title Picture",src:t(43041).A+"",width:"1600",height:"500"})}),"\n",(0,c.jsx)(n.header,{children:(0,c.jsx)(n.h1,{id:"cross-contract-calls",children:"Cross-Contract Calls"})}),"\n",(0,c.jsx)(n.p,{children:"In ink! contracts it is possible to call messages and constructors of other\non-chain contracts."}),"\n",(0,c.jsx)(n.p,{children:"There are a few approaches to performing these cross-contract calls in ink!:"}),"\n",(0,c.jsxs)(n.ol,{children:["\n",(0,c.jsxs)(n.li,{children:["Contract references (i.e ",(0,c.jsx)(n.code,{children:"ContractRef"}),")"]}),"\n",(0,c.jsxs)(n.li,{children:["Builders (i.e ",(0,c.jsx)(n.code,{children:"CreateBuilder"})," and ",(0,c.jsx)(n.code,{children:"CallBuilder"}),")"]}),"\n"]}),"\n",(0,c.jsx)(n.admonition,{type:"note",children:(0,c.jsx)(n.p,{children:"In general, contract references should be preferred over builders\nbecause they provide higher-level type-safe interfaces.\nOnly use builders if you need to manipulate low-level call parameters."})}),"\n",(0,c.jsx)(n.h2,{id:"contract-references",children:"Contract References"}),"\n",(0,c.jsx)(n.p,{children:'Contract references are wrapper types that can be used for interacting with an on-chain/"callee" contract\nusing a high-level type-safe interface.'}),"\n",(0,c.jsxs)(n.p,{children:["They are either statically generated by the ink! code generation (for contract dependencies),\nor they can be manually defined as dynamic interfaces using the ",(0,c.jsxs)(n.a,{href:"/docs/v6/macros-attributes/contract_ref",children:[(0,c.jsx)(n.code,{children:"#[ink::contract_ref]"})," attribute"]}),"."]}),"\n",(0,c.jsx)(n.h3,{id:"statically-generated-contract-references",children:"Statically generated contract references"}),"\n",(0,c.jsx)(n.p,{children:"To use statically generated contract references, you need to import the contract\nyou want to call as a dependency of your own contract."}),"\n",(0,c.jsxs)(n.admonition,{type:"note",children:[(0,c.jsx)(n.p,{children:"This means that this approach cannot be used if you want to interact with a contract\nthat is either built in another language (e.g. Solidity), or has no publicly available package/crate."}),(0,c.jsxs)(n.p,{children:["For ",(0,c.jsx)(n.a,{href:"/docs/v6/solidity-interop/calling-solidity-contracts",children:"calling Solidity Contracts"})," you will need to use either\n",(0,c.jsx)(n.a,{href:"#manually-defined-contract-references",children:"manually defined contract references"}),"\nusing the ",(0,c.jsxs)(n.a,{href:"/docs/v6/macros-attributes/contract_ref",children:[(0,c.jsx)(n.code,{children:"#[ink::contract_ref]"})," attribute"]})," (recommended),\nor the ",(0,c.jsx)(n.a,{href:"#builders",children:(0,c.jsx)(n.code,{children:"Builders"})})," approach instead."]})]}),"\n",(0,c.jsx)(n.h4,{id:"crosscontractcalls-walkthrough",children:(0,c.jsx)(n.strong,{children:"CrossContractCalls walkthrough"})}),"\n",(0,c.jsxs)(n.p,{children:["This walkthrough uses the ",(0,c.jsx)(n.a,{href:"https://github.com/use-ink/ink-examples/tree/master/cross-contract-calls",children:(0,c.jsx)(n.code,{children:"cross-contract-calls"})})," example to illustrate\nhow contract references enable cross-contract calls."]}),"\n",(0,c.jsx)(n.p,{children:"The general workflow will be:"}),"\n",(0,c.jsxs)(n.ol,{children:["\n",(0,c.jsxs)(n.li,{children:["Import ",(0,c.jsx)(n.code,{children:"OtherContract"})," into ",(0,c.jsx)(n.code,{children:"CrossContractCalls"})]}),"\n",(0,c.jsxs)(n.li,{children:["Call ",(0,c.jsx)(n.code,{children:"OtherContract"})," using ",(0,c.jsx)(n.code,{children:"CrossContractCalls"})]}),"\n"]}),"\n",(0,c.jsx)(n.h4,{id:"importing-othercontract",children:(0,c.jsxs)(n.strong,{children:["Importing ",(0,c.jsx)(n.code,{children:"OtherContract"})]})}),"\n",(0,c.jsxs)(n.p,{children:["We need to import ",(0,c.jsx)(n.code,{children:"OtherContract"})," to our ",(0,c.jsx)(n.code,{children:"CrossContractCalls"})," contract."]}),"\n",(0,c.jsxs)(n.p,{children:["First, we add the following lines to our ",(0,c.jsx)(n.code,{children:"Cargo.toml"})," file:"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-toml",children:'# In `cross-contract-calls/Cargo.toml`\n\nother-contract = { path = "other-contract", default-features = false, features = ["ink-as-dependency"] }\n\n# -- snip --\n\n[features]\ndefault = ["std"]\nstd = [\n    "ink/std",\n    # -- snip --\n    "other-contract/std",\n]\n'})}),"\n",(0,c.jsxs)(n.admonition,{type:"note",children:[(0,c.jsx)(n.p,{children:"There are two important things to emphasize here:"}),(0,c.jsxs)(n.ol,{children:["\n",(0,c.jsxs)(n.li,{children:["If we don't specify the ",(0,c.jsx)(n.code,{children:"ink-as-dependency"})," feature we will end up with linking\nerrors."]}),"\n",(0,c.jsxs)(n.li,{children:["If we don't enable the ",(0,c.jsx)(n.code,{children:"std"})," feature for ",(0,c.jsx)(n.code,{children:"std"})," builds we will not be able to generate\nour contract's metadata."]}),"\n"]})]}),"\n",(0,c.jsx)(n.h4,{id:"wiring-crosscontractcalls",children:(0,c.jsxs)(n.strong,{children:["Wiring ",(0,c.jsx)(n.code,{children:"CrossContractCalls"})]})}),"\n",(0,c.jsxs)(n.p,{children:["First, we will import the contract reference of ",(0,c.jsx)(n.code,{children:"OtherContract"}),",\nand declare the reference to be part of our storage struct."]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-rust",children:"// In `cross-contract-calls/lib.rs`\n\nuse other_contract::OtherContractRef;\n\n#[ink(storage)]\npub struct CrossContractCalls {\n    other_contract: OtherContractRef,\n}\n"})}),"\n",(0,c.jsxs)(n.p,{children:["Next, we will store the address of an instance of ",(0,c.jsx)(n.code,{children:"OtherContract"}),".\nWe do this from the constructor of our contract."]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-rust",children:"// In `cross-contract-calls/lib.rs`\n\n#[ink(constructor)]\npub fn new(other_contract_address: ink::Address) -> Self {\n    let other_contract = ink::env::call::FromAddr::from_addr(other_contract_address);\n    Self { other_contract }\n}\n"})}),"\n",(0,c.jsxs)(n.p,{children:["Once we have a contract reference to ",(0,c.jsx)(n.code,{children:"OtherContract"})," we can call its messages just\nlike normal Rust methods!"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-rust",children:"// In `cross-contract-calls/lib.rs`\n\n#[ink(message)]\npub fn flip_and_get(&mut self) -> bool {\n    self.other_contract.flip();\n    self.other_contract.get()\n}\n"})}),"\n",(0,c.jsx)(n.h4,{id:"instantiating-crosscontractcalls-with-an-address-for-othercontract",children:(0,c.jsxs)(n.strong,{children:["Instantiating ",(0,c.jsx)(n.code,{children:"CrossContractCalls"})," with an address for ",(0,c.jsx)(n.code,{children:"OtherContract"})]})}),"\n",(0,c.jsxs)(n.p,{children:["We will first need to instantiate ",(0,c.jsx)(n.code,{children:"CrossContractCalls"}),"."]}),"\n",(0,c.jsxs)(n.p,{children:["We will need an address of an instance of ",(0,c.jsx)(n.code,{children:"OtherContract"})," that is already on-chain\n(i.e. a ",(0,c.jsx)(n.code,{children:"20"})," bytes ",(0,c.jsxs)(n.a,{href:"https://use-ink.github.io/ink/ink/type.Address.html",children:[(0,c.jsx)(n.code,{children:"pallet-revive"})," address"]})," like ",(0,c.jsx)(n.code,{children:"0xd051d56ffc5077e006d1fdb14a2311276873aa86"}),")."]}),"\n",(0,c.jsxs)(n.admonition,{type:"note",children:[(0,c.jsxs)(n.p,{children:["For the next steps, you will either need the ",(0,c.jsx)(n.a,{href:"https://github.com/use-ink/ink-node",children:(0,c.jsx)(n.code,{children:"ink-node"})})," running in the background,\nor you'll need to provide the url of your target node."]}),(0,c.jsxs)(n.p,{children:["For the latter, see the instructions for ",(0,c.jsxs)(n.a,{href:"/docs/v6/getting-started/deploy-your-contract#deploying-to-passet-hub-testnet",children:["deploying to ",(0,c.jsx)(n.code,{children:"Passet Hub Testnet"})]})," as an example."]})]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:"# In the `cross-contract-calls` directory\ncargo contract build --release\ncargo contract instantiate \\\n    --constructor new \\\n    --args 0xd051d56ffc5077e006d1fdb14a2311276873aa86 \\\n    --suri //Alice --salt $(date +%s) \\\n    -x\n"})}),"\n",(0,c.jsxs)(n.p,{children:["If successful, this will output in a contract address for ",(0,c.jsx)(n.code,{children:"CrossContractCalls"})," similar to:"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:"Contract 0x427b4c31ce5cdc19ec19bc9d2fb0e22ba69c84c3\n"})}),"\n",(0,c.jsx)(n.h4,{id:"calling-othercontract-through-crosscontractcalls",children:(0,c.jsxs)(n.strong,{children:["Calling ",(0,c.jsx)(n.code,{children:"OtherContract"})," through ",(0,c.jsx)(n.code,{children:"CrossContractCalls"})]})}),"\n",(0,c.jsxs)(n.p,{children:["Finally, we can call the ",(0,c.jsx)(n.code,{children:"OtherContract"})," methods through ",(0,c.jsx)(n.code,{children:"CrossContractCalls"})," as follows:"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:"cargo contract call --contract 0x427b4c31ce5cdc19ec19bc9d2fb0e22ba69c84c3 \\\n    --message flip_and_get --suri //Alice --dry-run\n"})}),"\n",(0,c.jsx)(n.p,{children:"Which will result in something like:"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:"Result Ok(true)\nReverted false\n"})}),"\n",(0,c.jsx)(n.h3,{id:"manually-defined-contract-references",children:"Manually defined contract references"}),"\n",(0,c.jsxs)(n.p,{children:["See our section on using the ",(0,c.jsxs)(n.a,{href:"/docs/v6/macros-attributes/contract_ref",children:[(0,c.jsx)(n.code,{children:"#[ink::contract_ref]"})," attribute"]}),'\nfor a detailed description and examples of how to manually define the dynamic interface\nfor an on-chain/"callee" contract, and use the generated contract reference\nfor calling the on-chain/"callee" contract in a type-safe manner.']}),"\n",(0,c.jsxs)(n.admonition,{type:"caution",children:[(0,c.jsx)(n.p,{children:"A downside to manually defined contract references is that mistakes\nin the interface definition are not caught at compile-time."}),(0,c.jsxs)(n.p,{children:["It's therefore important to make sure such interfaces are properly tested\nusing ",(0,c.jsx)(n.a,{href:"/docs/v6/contract-testing/end-to-end-e2e-testing",children:"end-to-end testing"})," before contracts are deployed on-chain."]})]}),"\n",(0,c.jsx)(n.h2,{id:"builders",children:"Builders"}),"\n",(0,c.jsxs)(n.p,{children:["The ",(0,c.jsx)(n.a,{href:"https://use-ink.github.io/ink/ink_env/call/struct.CreateBuilder.html",children:(0,c.jsx)(n.code,{children:"CreateBuilder"})})," and ",(0,c.jsx)(n.a,{href:"https://use-ink.github.io/ink/ink_env/call/struct.CallBuilder.html",children:(0,c.jsx)(n.code,{children:"CallBuilder"})}),"\noffer low-level, flexible interfaces for performing cross-contract calls.\nThe ",(0,c.jsx)(n.code,{children:"CreateBuilder"})," allows you to instantiate already uploaded contracts,\nand the ",(0,c.jsx)(n.code,{children:"CallBuilder"})," allows you to call messages on instantiated contracts."]}),"\n",(0,c.jsxs)(n.admonition,{type:"caution",children:[(0,c.jsxs)(n.p,{children:["A downside to low-level ",(0,c.jsx)(n.code,{children:"CreateBuilder"}),"s and ",(0,c.jsx)(n.code,{children:"CallBuilder"}),"s is that mistakes\nin the generated calls (e.g. wrong selectors, wrong order and/or types of arguments e.t.c)\nare not caught at compile-time."]}),(0,c.jsxs)(n.p,{children:["It's therefore important to make sure such calls are properly tested\nusing ",(0,c.jsx)(n.a,{href:"/docs/v6/contract-testing/end-to-end-e2e-testing",children:"end-to-end testing"})," before contracts are deployed on-chain."]})]}),"\n",(0,c.jsx)(n.h3,{id:"createbuilder",children:"CreateBuilder"}),"\n",(0,c.jsxs)(n.p,{children:["The ",(0,c.jsx)(n.code,{children:"CreateBuilder"})," offers an easy way for you to ",(0,c.jsx)(n.strong,{children:"instantiate"})," a contract.\nNote that you'll still need this contract to have been previously uploaded."]}),"\n",(0,c.jsx)(n.admonition,{type:"note",children:(0,c.jsxs)(n.p,{children:["For a refresher on the difference between ",(0,c.jsx)(n.code,{children:"upload"})," and ",(0,c.jsx)(n.code,{children:"instantiate"}),"\n",(0,c.jsx)(n.a,{href:"/docs/v6/getting-started/deploy-your-contract",children:"see here"}),"."]})}),"\n",(0,c.jsxs)(n.p,{children:["In order to instantiate a contract you need a reference to your contract, just like in\n",(0,c.jsx)(n.a,{href:"#contract-references",children:"the previous section"}),"."]}),"\n",(0,c.jsxs)(n.p,{children:["Below is an example of how to instantiate a contract using the ",(0,c.jsx)(n.code,{children:"CreateBuilder"}),". We will:"]}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["instantiate the uploaded contract with a ",(0,c.jsx)(n.code,{children:"code_hash"})," of ",(0,c.jsx)(n.code,{children:"0x4242..."})]}),"\n",(0,c.jsxs)(n.li,{children:["with no gas limit specified (",(0,c.jsx)(n.code,{children:"0"})," means unlimited)"]}),"\n",(0,c.jsxs)(n.li,{children:["sending ",(0,c.jsx)(n.code,{children:"10"})," units of transferred value to the contract instance"]}),"\n",(0,c.jsxs)(n.li,{children:["instantiating with the ",(0,c.jsx)(n.code,{children:"new"})," constructor"]}),"\n",(0,c.jsxs)(n.li,{children:["with the following arguments","\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["a ",(0,c.jsx)(n.code,{children:"u8"})," with value ",(0,c.jsx)(n.code,{children:"42"})]}),"\n",(0,c.jsxs)(n.li,{children:["a ",(0,c.jsx)(n.code,{children:"bool"})," with value ",(0,c.jsx)(n.code,{children:"true"})]}),"\n",(0,c.jsxs)(n.li,{children:["an array of 32 ",(0,c.jsx)(n.code,{children:"u8"})," with value ",(0,c.jsx)(n.code,{children:"0x10"})]}),"\n"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["generate the address (",(0,c.jsx)(n.code,{children:"AccountId"}),") using the specified ",(0,c.jsx)(n.code,{children:"salt_bytes"})]}),"\n",(0,c.jsxs)(n.li,{children:["and we expect it to return a value of type ",(0,c.jsx)(n.code,{children:"MyContractRef"})]}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-rust",children:'use contract::MyContractRef;\nlet my_contract: MyContractRef = build_create::<MyContractRef>()\n    .code_hash(Hash::from([0x42; 32]))\n    .ref_time_limit(0)\n    .endowment(10)\n    .exec_input(\n        ExecutionInput::new(Selector::new(ink::selector_bytes!("new")))\n            .push_arg(42)\n            .push_arg(true)\n            .push_arg(&[0x10u8; 32])\n    )\n    .salt_bytes(&[0xDE, 0xAD, 0xBE, 0xEF])\n    .returns::<MyContractRef>()\n    .instantiate();\n'})}),"\n",(0,c.jsxs)(n.p,{children:["Since ",(0,c.jsx)(n.code,{children:"CreateBuilder::instantiate()"})," returns a contract reference, we can use this\ncontract reference to call messages just like in the\n",(0,c.jsx)(n.a,{href:"#contract-references",children:"previous section"}),"."]}),"\n",(0,c.jsx)(n.admonition,{type:"note",children:(0,c.jsxs)(n.p,{children:["To instantiate a Solidity ABI contract, see ",(0,c.jsx)(n.a,{href:"/docs/v6/solidity-interop/calling-solidity-contracts",children:"Calling Solidity Contracts"}),"."]})}),"\n",(0,c.jsx)(n.h3,{id:"callbuilder",children:"CallBuilder"}),"\n",(0,c.jsxs)(n.p,{children:["The ",(0,c.jsx)(n.code,{children:"CallBuilder"})," gives you a couple of ways to call messages from other contracts. There\nare two main approaches to this: ",(0,c.jsx)(n.code,{children:"Call"}),"s and ",(0,c.jsx)(n.code,{children:"DelegateCall"}),"s. We will briefly cover both\nhere."]}),"\n",(0,c.jsx)(n.h4,{id:"callbuilder-call",children:(0,c.jsx)(n.strong,{children:"CallBuilder: Call"})}),"\n",(0,c.jsxs)(n.p,{children:["When using ",(0,c.jsx)(n.code,{children:"Call"}),"s the ",(0,c.jsx)(n.code,{children:"CallBuilder"})," requires an already instantiated contract."]}),"\n",(0,c.jsxs)(n.p,{children:["We saw an example of how to use the ",(0,c.jsx)(n.code,{children:"CreateBuilder"})," to instantiate contracts in the\n",(0,c.jsx)(n.a,{href:"#contract-references",children:"previous section"}),"."]}),"\n",(0,c.jsxs)(n.p,{children:["Below is an example of how to call a contract using the ",(0,c.jsx)(n.code,{children:"CallBuilder"}),". We will:"]}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["make a regular ",(0,c.jsx)(n.code,{children:"Call"})]}),"\n",(0,c.jsxs)(n.li,{children:["to a contract at the address ",(0,c.jsx)(n.code,{children:"0x4242..."})]}),"\n",(0,c.jsxs)(n.li,{children:["with no gas limit specified (",(0,c.jsx)(n.code,{children:"0"})," means unlimited)"]}),"\n",(0,c.jsxs)(n.li,{children:["sending ",(0,c.jsx)(n.code,{children:"10"})," units of transferred value to the contract instance"]}),"\n",(0,c.jsxs)(n.li,{children:["calling the ",(0,c.jsx)(n.code,{children:"flip"})," message"]}),"\n",(0,c.jsxs)(n.li,{children:["with the following arguments","\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["a ",(0,c.jsx)(n.code,{children:"u8"})," with value ",(0,c.jsx)(n.code,{children:"42"})]}),"\n",(0,c.jsxs)(n.li,{children:["a ",(0,c.jsx)(n.code,{children:"bool"})," with value ",(0,c.jsx)(n.code,{children:"true"})]}),"\n",(0,c.jsxs)(n.li,{children:["an array of 32 ",(0,c.jsx)(n.code,{children:"u8"})," with value ",(0,c.jsx)(n.code,{children:"0x10"})]}),"\n"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["and we expect it to return a value of type ",(0,c.jsx)(n.code,{children:"bool"})]}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-rust",children:'let my_return_value = build_call::<DefaultEnvironment>()\n    .call(H160::from([0x42; 20]))\n    .ref_time_limit(0)\n    .transferred_value(10)\n    .exec_input(\n        ExecutionInput::new(Selector::new(ink::selector_bytes!("flip")))\n            .push_arg(42u8)\n            .push_arg(true)\n            .push_arg(&[0x10u8; 32])\n    )\n    .returns::<bool>()\n    .invoke();\n'})}),"\n",(0,c.jsxs)(n.admonition,{type:"caution",children:[(0,c.jsxs)(n.p,{children:["Message arguments will be encoded in the order in which they are provided to the ",(0,c.jsx)(n.code,{children:"CallBuilder"}),".\nThis means that they should match the order (and type) they appear in the function\nsignature."]}),(0,c.jsxs)(n.p,{children:["You will not get any feedback about this at compile-time,\nso it's important to make sure such calls are properly tested\nwith ",(0,c.jsx)(n.a,{href:"/docs/v6/contract-testing/end-to-end-e2e-testing",children:"end-to-end testing"})," before contracts are deployed on-chain."]})]}),"\n",(0,c.jsx)(n.admonition,{type:"note",children:(0,c.jsxs)(n.p,{children:["To call Solidity ABI-encoded contracts, see ",(0,c.jsx)(n.a,{href:"/docs/v6/solidity-interop/calling-solidity-contracts",children:"Calling Solidity Contracts"}),"."]})}),"\n",(0,c.jsx)(n.h4,{id:"callbuilder-delegate-call",children:(0,c.jsx)(n.strong,{children:"CallBuilder: Delegate Call"})}),"\n",(0,c.jsxs)(n.p,{children:["You can also use the ",(0,c.jsx)(n.code,{children:"CallBuilder"})," to craft calls using ",(0,c.jsx)(n.code,{children:"DelegateCall"})," mechanics.\nIf you need a refresher on what delegate calls are,\n",(0,c.jsx)(n.a,{href:"https://medium.com/coinmonks/delegatecall-calling-another-contract-function-in-solidity-b579f804178c",children:"see this article"}),"."]}),"\n",(0,c.jsxs)(n.p,{children:["In the case of ",(0,c.jsx)(n.code,{children:"DelegateCall"}),"s, we don't require an already instantiated contract.\nWe only need the ",(0,c.jsx)(n.code,{children:"code_hash"})," of an uploaded contract."]}),"\n",(0,c.jsxs)(n.p,{children:["Below is an example of how to delegate call a contract using the ",(0,c.jsx)(n.code,{children:"CallBuilder"}),". We will:"]}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["make a ",(0,c.jsx)(n.code,{children:"DelegateCall"})]}),"\n",(0,c.jsxs)(n.li,{children:["to a contract with a ",(0,c.jsx)(n.code,{children:"code_hash"})," (not contract address!) of ",(0,c.jsx)(n.code,{children:"0x4242..."})]}),"\n",(0,c.jsxs)(n.li,{children:["calling the ",(0,c.jsx)(n.code,{children:"flip"})," message"]}),"\n",(0,c.jsxs)(n.li,{children:["with the following arguments","\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["a ",(0,c.jsx)(n.code,{children:"u8"})," with value ",(0,c.jsx)(n.code,{children:"42"})]}),"\n",(0,c.jsxs)(n.li,{children:["a ",(0,c.jsx)(n.code,{children:"bool"})," with value ",(0,c.jsx)(n.code,{children:"true"})]}),"\n",(0,c.jsxs)(n.li,{children:["an array of 32 ",(0,c.jsx)(n.code,{children:"u8"})," with value ",(0,c.jsx)(n.code,{children:"0x10"})]}),"\n"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["and we expect it to return an ",(0,c.jsx)(n.code,{children:"i32"})]}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-rust",children:'let my_return_value = build_call::<DefaultEnvironment>()\n    .delegate(H160::from([0x42; 20]))\n    .exec_input(\n        ExecutionInput::new(Selector::new(ink::selector_bytes!("flip")))\n            .push_arg(42u8)\n            .push_arg(true)\n            .push_arg(&[0x10u8; 32])\n    )\n    .returns::<i32>()\n    .invoke();\n'})}),"\n",(0,c.jsx)(n.h3,{id:"builder-error-handling",children:"Builder Error Handling"}),"\n",(0,c.jsxs)(n.p,{children:["The ",(0,c.jsx)(n.code,{children:"CreateBuilder"})," and the ",(0,c.jsx)(n.code,{children:"CallBuilder"})," both offer error handling with the\n",(0,c.jsx)(n.code,{children:"try_instantiate()"})," and ",(0,c.jsx)(n.code,{children:"try_invoke()"})," methods respectively."]}),"\n",(0,c.jsx)(n.p,{children:"These allow contract developers to handle two types of errors:"}),"\n",(0,c.jsxs)(n.ol,{children:["\n",(0,c.jsx)(n.li,{children:"Errors from the underlying execution environment (e.g the Contracts pallet)"}),"\n",(0,c.jsxs)(n.li,{children:["Error from the programming language (e.g ",(0,c.jsx)(n.code,{children:"LangError"}),"s)"]}),"\n"]}),"\n",(0,c.jsxs)(n.p,{children:["See the documentation for\n",(0,c.jsx)(n.a,{href:"https://use-ink.github.io/ink/ink_env/call/struct.CreateBuilder.html#method.try_instantiate",children:(0,c.jsx)(n.code,{children:"try_instantiate"})}),",\n",(0,c.jsx)(n.a,{href:"https://use-ink.github.io/ink/ink_env/call/struct.CallBuilder.html#method.try_invoke-2",children:(0,c.jsx)(n.code,{children:"try_invoke"})}),",\n",(0,c.jsx)(n.a,{href:"https://use-ink.github.io/ink/ink_env/enum.Error.html",children:(0,c.jsx)(n.code,{children:"ink::env::Error"})}),"\nand\n",(0,c.jsx)(n.a,{href:"https://use-ink.github.io/ink/ink/enum.LangError.html",children:(0,c.jsx)(n.code,{children:"ink::LangError"})}),"\nfor more details on proper error handling."]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,c.jsx)(n,{...e,children:(0,c.jsx)(d,{...e})}):d(e)}}}]);