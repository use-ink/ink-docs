"use strict";(self.webpackChunkink_docs=self.webpackChunkink_docs||[]).push([[1578],{65404:(e,n,i)=>{i.d(n,{R:()=>d,x:()=>o});var t=i(36672);const r={},s=t.createContext(r);function d(e){const n=t.useContext(s);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:d(e.components),t.createElement(s.Provider,{value:n},e.children)}},92164:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>a,frontMatter:()=>d,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"integrations-and-sdks/ethereum-compatibility","title":"Ethereum Compatibility","description":"Metadata Title Picture","source":"@site/docs/integrations-and-sdks/ethereum-compatibility.md","sourceDirName":"integrations-and-sdks","slug":"/background/solidity-metamask-compatibility","permalink":"/docs/v6/background/solidity-metamask-compatibility","draft":false,"unlisted":false,"editUrl":"https://github.com/use-ink/ink-docs/edit/master/docs/integrations-and-sdks/ethereum-compatibility.md","tags":[],"version":"current","frontMatter":{"title":"Ethereum Compatibility","hide_title":true,"slug":"/background/solidity-metamask-compatibility"},"sidebar":"reference","previous":{"title":"Other Languages","permalink":"/docs/v6/integrations-and-sdks/other-languages"},"next":{"title":"Polkadot SDK and ink!","permalink":"/docs/v6/background/polkadot-sdk"}}');var r=i(23420),s=i(65404);const d={title:"Ethereum Compatibility",hide_title:!0,slug:"/background/solidity-metamask-compatibility"},o=void 0,l={},c=[{value:"Rust/ink! to Solidity ABI type mapping",id:"rustink-to-solidity-abi-type-mapping",level:2},{value:"Default/provided mappings",id:"defaultprovided-mappings",level:3},{value:"Handling the <code>Result&lt;T, E&gt;</code> type",id:"handling-the-resultt-e-type",level:3},{value:"Mappings for arbitrary custom types",id:"mappings-for-arbitrary-custom-types",level:3},{value:"Solidity Tooling",id:"solidity-tooling",level:2}];function h(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components},{Head:t}=n;return t||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Head",!0),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(t,{children:[(0,r.jsx)("meta",{name:"description",content:"Explanation of ink!'s compatibility with Solidity and Ethereum tooling (MetaMask, block explorers, Hardhat, \u2026)."}),(0,r.jsx)("meta",{name:"keywords",content:"Ethereum, MetaMask, Solidity, Hardhat, ink!"}),(0,r.jsx)("meta",{property:"og:title",content:"Solidity & MetaMask Compatibility"}),(0,r.jsx)("meta",{property:"og:description",content:"Explanation of ink!'s compatibility with Solidity and Ethereum tooling (MetaMask, block explorers, Hardhat, \u2026)."}),(0,r.jsx)("meta",{property:"og:image",content:"https://use-ink.com/img/opengraph/solidity-metamask.jpg"}),(0,r.jsx)("meta",{property:"og:image:width",content:"1200"}),(0,r.jsx)("meta",{property:"og:image:height",content:"630"}),(0,r.jsx)("meta",{property:"og:image:alt",content:"Solidity and MetaMask"}),(0,r.jsx)("meta",{property:"og:image:type",content:"image/jpg"})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Metadata Title Picture",src:i(99905).A+"",width:"1600",height:"500"})}),"\n",(0,r.jsxs)(n.p,{children:["First, read our blogpost ",(0,r.jsx)(n.a,{href:"https://medium.com/coinsbench/ink-solidity-abi-on-polkavm-c675c854efd3",children:"ink! speaks Solidity on PolkaVM"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["With ink! v6, we have introduced an ",(0,r.jsx)(n.code,{children:"abi"})," field in a custom ",(0,r.jsx)(n.code,{children:"ink-lang"})," table\nin the ",(0,r.jsxs)(n.a,{href:"https://doc.rust-lang.org/cargo/reference/manifest.html#the-metadata-table",children:[(0,r.jsx)(n.code,{children:"package.metadata"})," table"]})," of a contract's manifest\nfile (i.e. the ",(0,r.jsx)(n.code,{children:"Cargo.toml"})," file) - ",(0,r.jsx)(n.a,{href:"/docs/v6/basics/abi#declaring-the-abi",children:"more details here"}),".\nIt allows building your contract in Solidity ABI compatibility mode\nwhen declared as follows:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-toml",children:'[package.metadata.ink-lang]\nabi = "sol"\n'})}),"\n",(0,r.jsx)(n.p,{children:"The implication of supporting Solidity ABI encoding is that all types used as\nconstructor/message argument and return types, and event argument types must\ndefine a mapping to an equivalent Solidity ABI type."}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["This is similar to the requirement to implement ",(0,r.jsxs)(n.a,{href:"https://docs.rs/parity-scale-codec/latest/parity_scale_codec",children:[(0,r.jsx)(n.code,{children:"scale::Encode"})," and ",(0,r.jsx)(n.code,{children:"scale::Decode"})]}),'\nfor Rust types used in the public interfaces of ink!/"native" ABI encoded contracts.']})}),"\n",(0,r.jsx)(n.h2,{id:"rustink-to-solidity-abi-type-mapping",children:"Rust/ink! to Solidity ABI type mapping"}),"\n",(0,r.jsxs)(n.p,{children:["This mapping is defined using the ",(0,r.jsx)(n.a,{href:"https://use-ink.github.io/ink/ink/trait.SolEncode.html",children:(0,r.jsx)(n.code,{children:"SolEncode"})})," and ",(0,r.jsx)(n.a,{href:"https://use-ink.github.io/ink/ink/trait.SolDecode.html",children:(0,r.jsx)(n.code,{children:"SolDecode"})})," traits,\nwhich are analogs to ",(0,r.jsxs)(n.a,{href:"https://docs.rs/parity-scale-codec/latest/parity_scale_codec",children:[(0,r.jsx)(n.code,{children:"scale::Encode"})," and ",(0,r.jsx)(n.code,{children:"scale::Decode"})]}),"\n(but for Solidity ABI encoding/decoding).\nYou won't be able to use Rust types for which no mapping to a Solidity type is defined.\nAn error about a missing trait implementation for this type will be thrown."]}),"\n",(0,r.jsx)(n.h3,{id:"defaultprovided-mappings",children:"Default/provided mappings"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"https://use-ink.github.io/ink/ink/trait.SolEncode.html",children:(0,r.jsx)(n.code,{children:"SolEncode"})})," and ",(0,r.jsx)(n.a,{href:"https://use-ink.github.io/ink/ink/trait.SolDecode.html",children:(0,r.jsx)(n.code,{children:"SolDecode"})})," are implemented\nfor the following Rust/ink! primitive types creating a mapping\nto the corresponding Solidity ABI types as shown in the table below:"]}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Rust/ink! type"}),(0,r.jsx)(n.th,{children:"Solidity ABI type"}),(0,r.jsx)(n.th,{children:"Notes"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"bool"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"bool"})}),(0,r.jsx)(n.td,{})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"iN"})," for ",(0,r.jsx)(n.code,{children:"N \u2208 {8,16,32,64,128}"})]}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"intN"})}),(0,r.jsxs)(n.td,{children:["e.g ",(0,r.jsx)(n.code,{children:"i8"})," \u2194 ",(0,r.jsx)(n.code,{children:"int8"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"uN"})," for ",(0,r.jsx)(n.code,{children:"N \u2208 {8,16,32,64,128}"})]}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"uintN"})}),(0,r.jsxs)(n.td,{children:["e.g ",(0,r.jsx)(n.code,{children:"u8"})," \u2194 ",(0,r.jsx)(n.code,{children:"uint8"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"https://use-ink.github.io/ink/ink/struct.U256.html",children:(0,r.jsx)(n.code,{children:"ink::U256"})})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"uint256"})}),(0,r.jsx)(n.td,{})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"String"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"string"})}),(0,r.jsx)(n.td,{})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"Box<str>"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"string"})}),(0,r.jsx)(n.td,{})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.a,{href:"https://use-ink.github.io/ink/ink/type.Address.html",children:(0,r.jsx)(n.code,{children:"ink::Address"})})," / ",(0,r.jsx)(n.a,{href:"https://use-ink.github.io/ink/ink/struct.H160.html",children:(0,r.jsx)(n.code,{children:"ink::H160"})})]}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"address"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"ink::Address"})," is a type alias for the ",(0,r.jsx)(n.code,{children:"ink::H160"})," type used for addresses in ",(0,r.jsx)(n.code,{children:"pallet-revive"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"[T; N]"})," for ",(0,r.jsx)(n.code,{children:"const N: usize"})]}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"T[N]"})}),(0,r.jsxs)(n.td,{children:["e.g. ",(0,r.jsx)(n.code,{children:"[i8; 64]"})," \u2194 ",(0,r.jsx)(n.code,{children:"int8[64]"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"Vec<T>"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"T[]"})}),(0,r.jsxs)(n.td,{children:["e.g. ",(0,r.jsx)(n.code,{children:"Vec<i8>"})," \u2194 ",(0,r.jsx)(n.code,{children:"int8[]"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"Box<[T]>"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"T[]"})}),(0,r.jsxs)(n.td,{children:["e.g. ",(0,r.jsx)(n.code,{children:"Box<[i8]>"})," \u2194 ",(0,r.jsx)(n.code,{children:"int8[]"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.a,{href:"https://use-ink.github.io/ink/ink/sol/struct.FixedBytes.html",children:(0,r.jsx)(n.code,{children:"ink::sol::FixedBytes<N>"})})," for ",(0,r.jsx)(n.code,{children:"1 <= N <= 32"})]}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"bytesN"})}),(0,r.jsxs)(n.td,{children:["e.g. ",(0,r.jsx)(n.code,{children:"FixedBytes<32>"})," \u2194 ",(0,r.jsx)(n.code,{children:"bytes32"}),", ",(0,r.jsx)(n.code,{children:"FixedBytes<N>"})," is just a newtype wrapper for ",(0,r.jsx)(n.code,{children:"[u8; N]"})," that also implements ",(0,r.jsx)(n.code,{children:"From<u8>"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"https://use-ink.github.io/ink/ink/sol/struct.DynBytes.html",children:(0,r.jsx)(n.code,{children:"ink::sol::DynBytes"})})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"bytes"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"DynBytes"})," is just a newtype wrapper for ",(0,r.jsx)(n.code,{children:"Vec<u8>"})," that also implements ",(0,r.jsx)(n.code,{children:"From<Box<[u8]>>"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"(T1, T2, T3, ... T12)"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"(U1, U2, U3, ... U12)"})}),(0,r.jsxs)(n.td,{children:["where ",(0,r.jsx)(n.code,{children:"T1"})," \u2194 ",(0,r.jsx)(n.code,{children:"U1"}),", ... ",(0,r.jsx)(n.code,{children:"T12"})," \u2194 ",(0,r.jsx)(n.code,{children:"U12"})," e.g. ",(0,r.jsx)(n.code,{children:"(bool, u8, Address)"})," \u2194 ",(0,r.jsx)(n.code,{children:"(bool, uint8, address)"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"Option<T>"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"(bool, T)"})}),(0,r.jsxs)(n.td,{children:["e.g. ",(0,r.jsx)(n.code,{children:"Option<u8>"})," \u2194 ",(0,r.jsx)(n.code,{children:"(bool, uint8)"})]})]})]})]}),"\n",(0,r.jsxs)(n.admonition,{type:"note",children:[(0,r.jsxs)(n.p,{children:["Rust's ",(0,r.jsx)(n.code,{children:"Option<T>"})," type doesn't have a ",(0,r.jsx)(n.strong,{children:"semantically"})," equivalent Solidity ABI type,\nbecause ",(0,r.jsx)(n.a,{href:"https://docs.soliditylang.org/en/latest/types.html#enums",children:"Solidity enums"})," are field-less."]}),(0,r.jsxs)(n.p,{children:["So ",(0,r.jsx)(n.code,{children:"Option<T>"})," is mapped to a tuple representation instead (i.e. ",(0,r.jsx)(n.code,{children:"(bool, T)"}),"),\nbecause this representation allows preservation of semantic information in Solidity,\nby using the ",(0,r.jsx)(n.code,{children:"bool"}),' as a "flag" indicating the variant\n(i.e. ',(0,r.jsx)(n.code,{children:"false"})," for ",(0,r.jsx)(n.code,{children:"None"})," and ",(0,r.jsx)(n.code,{children:"true"})," for ",(0,r.jsx)(n.code,{children:"Some"}),") such that:"]}),(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Option::None"})," is mapped to ",(0,r.jsx)(n.code,{children:"(false, <default_value>)"}),"\nwhere ",(0,r.jsx)(n.code,{children:"<default_value>"})," is the zero bytes only representation of ",(0,r.jsx)(n.code,{children:"T"}),"\n(e.g. ",(0,r.jsx)(n.code,{children:"0u8"})," for ",(0,r.jsx)(n.code,{children:"u8"})," or ",(0,r.jsx)(n.code,{children:"Vec::new()"})," for ",(0,r.jsx)(n.code,{children:"Vec<T>"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Option::Some(value)"})," is mapped to ",(0,r.jsx)(n.code,{children:"(true, value)"})]}),"\n"]}),(0,r.jsx)(n.p,{children:'The resulting type in Solidity can be represented as a struct with a field for the "flag"\nand another for the data.'}),(0,r.jsxs)(n.p,{children:["Note that ",(0,r.jsx)(n.code,{children:"enum"})," in Solidity is encoded as ",(0,r.jsx)(n.code,{children:"uint8"})," in ",(0,r.jsx)(n.a,{href:"https://docs.soliditylang.org/en/latest/abi-spec.html#mapping-solidity-to-abi-types",children:"Solidity ABI encoding"}),",\nwhile the encoding for ",(0,r.jsx)(n.code,{children:"bool"})," is equivalent to the encoding of ",(0,r.jsx)(n.code,{children:"uint8"}),",\nwith ",(0,r.jsx)(n.code,{children:"true"})," equivalent to ",(0,r.jsx)(n.code,{children:"1"})," and ",(0,r.jsx)(n.code,{children:"false"})," equivalent to ",(0,r.jsx)(n.code,{children:"0"}),".\nTherefore, the ",(0,r.jsx)(n.code,{children:"bool"}),' "flag" can be safely interpreted as a ',(0,r.jsx)(n.code,{children:"bool"})," or ",(0,r.jsx)(n.code,{children:"enum"})," (or even ",(0,r.jsx)(n.code,{children:"uint8"}),")\nin Solidity code."]})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"https://use-ink.github.io/ink/ink/trait.SolEncode.html",children:(0,r.jsx)(n.code,{children:"SolEncode"})})," is additionally implemented for reference and smart\npointer types below:"]}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Rust/ink! type"}),(0,r.jsx)(n.th,{children:"Solidity ABI type"}),(0,r.jsx)(n.th,{children:"Notes"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"&str"}),", ",(0,r.jsx)(n.code,{children:"&mut str"})]}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"string"})}),(0,r.jsx)(n.td,{})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"&T"}),", ",(0,r.jsx)(n.code,{children:"&mut T"}),", ",(0,r.jsx)(n.code,{children:"Box<T>"})]}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"T"})}),(0,r.jsxs)(n.td,{children:["e.g. ",(0,r.jsx)(n.code,{children:"&i8 \u2194 int8"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"&[T]"}),", ",(0,r.jsx)(n.code,{children:"&mut [T]"})]}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"T[]"})}),(0,r.jsxs)(n.td,{children:["e.g. ",(0,r.jsx)(n.code,{children:"&[i8]"})," \u2194 ",(0,r.jsx)(n.code,{children:"int8[]"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"https://use-ink.github.io/ink/ink/sol/struct.ByteSlice.html",children:(0,r.jsx)(n.code,{children:"ink::sol::ByteSlice"})})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"bytes"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"ByteSlice"})," is a just newtype wrapper for ",(0,r.jsx)(n.code,{children:"&[u8]"})]})]})]})]}),"\n",(0,r.jsxs)(n.h3,{id:"handling-the-resultt-e-type",children:["Handling the ",(0,r.jsx)(n.code,{children:"Result<T, E>"})," type"]}),"\n",(0,r.jsxs)(n.p,{children:["Rust's ",(0,r.jsx)(n.code,{children:"Result<T, E>"})," type doesn't have a ",(0,r.jsx)(n.strong,{children:"semantically"})," equivalent Solidity ABI type,\nbecause ",(0,r.jsx)(n.a,{href:"https://docs.soliditylang.org/en/latest/types.html#enums",children:"Solidity enums"})," are field-less, so no composable mapping is provided."]}),"\n",(0,r.jsxs)(n.p,{children:["However, ",(0,r.jsx)(n.code,{children:"Result<T, E>"})," types are supported as the return type of messages\nand constructors, and they're handled at language level as follows:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["When returning the ",(0,r.jsx)(n.code,{children:"Result::Ok"})," variant, where ",(0,r.jsx)(n.code,{children:"T"})," implements ",(0,r.jsx)(n.code,{children:"SolEncode"}),",\n",(0,r.jsx)(n.code,{children:"T"}),' is encoded as "normal" Solidity ABI return data.']}),"\n",(0,r.jsxs)(n.li,{children:["When returning the ",(0,r.jsx)(n.code,{children:"Result::Err"})," variant, ",(0,r.jsx)(n.code,{children:"E"})," must implement ",(0,r.jsx)(n.a,{href:"https://use-ink.github.io/ink/ink/sol/trait.SolErrorEncode.html",children:(0,r.jsx)(n.code,{children:"SolErrorEncode"})}),",\nink! will set the revert flag in the execution environment,\nand ",(0,r.jsx)(n.code,{children:"E"})," will be encoded as ",(0,r.jsx)(n.a,{href:"https://docs.soliditylang.org/en/latest/control-structures.html#revert",children:"Solidity revert error data"}),",\nwith the error data representation depending on the ",(0,r.jsx)(n.a,{href:"https://use-ink.github.io/ink/ink/sol/trait.SolErrorEncode.html",children:(0,r.jsx)(n.code,{children:"SolErrorEncode"})})," implementation."]}),"\n",(0,r.jsxs)(n.li,{children:["Similarly, for decoding, ",(0,r.jsx)(n.code,{children:"T"})," must implement ",(0,r.jsx)(n.code,{children:"SolDecode"}),",\nwhile ",(0,r.jsx)(n.code,{children:"E"})," must implement ",(0,r.jsx)(n.a,{href:"https://use-ink.github.io/ink/ink/sol/trait.SolErrorDecode.html",children:(0,r.jsx)(n.code,{children:"SolErrorDecode"})}),", and the returned data is decoded as ",(0,r.jsx)(n.code,{children:"T"}),"\n(i.e. ",(0,r.jsx)(n.code,{children:"Result::Ok"}),") or ",(0,r.jsx)(n.code,{children:"E"})," (i.e. ",(0,r.jsx)(n.code,{children:"Result::Err"}),") depending on whether\nthe revert flag is set (i.e. ",(0,r.jsx)(n.code,{children:"E"})," if the revert flag is set, and ",(0,r.jsx)(n.code,{children:"T"})," otherwise)."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.a,{href:"https://use-ink.github.io/ink/ink/sol/trait.SolErrorEncode.html",children:(0,r.jsx)(n.code,{children:"SolErrorEncode"})})," and ",(0,r.jsx)(n.a,{href:"https://use-ink.github.io/ink/ink/sol/trait.SolErrorDecode.html",children:(0,r.jsx)(n.code,{children:"SolErrorDecode"})})," traits define\nthe highest level interfaces for encoding and decoding an arbitrary Rust/ink! error type as\nSolidity ABI revert error data."]}),"\n",(0,r.jsxs)(n.p,{children:["Default implementations for both ",(0,r.jsx)(n.code,{children:"SolErrorEncode"})," and ",(0,r.jsx)(n.code,{children:"SolErrorDecode"})," are provided for unit\n(i.e. ",(0,r.jsx)(n.code,{children:"()"}),"), and these are equivalent to reverting with no error data in Solidity\n(i.e. empty output buffer)."]}),"\n",(0,r.jsxs)(n.p,{children:["For arbitrary custom error types, ",(0,r.jsx)(n.code,{children:"Derive"})," macros are provided for automatically generating\nimplementations of ",(0,r.jsx)(n.code,{children:"SolErrorEncode"})," and ",(0,r.jsx)(n.code,{children:"SolErrorDecode"})," for structs and enums for which\nall fields (if any) implement ",(0,r.jsx)(n.code,{children:"SolEncode"})," and ",(0,r.jsx)(n.code,{children:"SolDecode"}),"."]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["For structs, the struct name is used as the name of the ",(0,r.jsx)(n.a,{href:"https://soliditylang.org/blog/2021/04/21/custom-errors/",children:"Solidity custom error"}),"\nwhile the fields (if any) are the parameters"]}),"\n",(0,r.jsxs)(n.li,{children:["For enums, each variant is its own ",(0,r.jsx)(n.a,{href:"https://soliditylang.org/blog/2021/04/21/custom-errors/",children:"Solidity custom error"}),",\nwith the variant name being the custom error name, and the fields (if any) being the parameters"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["For convenience, the ",(0,r.jsx)(n.a,{href:"/docs/v6/macros-attributes/error",children:(0,r.jsx)(n.code,{children:"#[ink::error]"})})," attribute macro is also provided for automatically deriving the following traits:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://use-ink.github.io/ink/ink/sol/trait.SolErrorEncode.html",children:(0,r.jsx)(n.code,{children:"SolErrorEncode"})}),": for encoding a custom type as revert error data"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://use-ink.github.io/ink/ink/sol/trait.SolErrorDecode.html",children:(0,r.jsx)(n.code,{children:"SolErrorDecode"})}),": for decoding revert error data into a custom type"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"SolErrorMetadata"}),": for generating ",(0,r.jsx)(n.a,{href:"https://docs.soliditylang.org/en/latest/abi-spec.html#json",children:"Solidity ABI metadata"})," (gated behind the ",(0,r.jsx)(n.code,{children:"std"})," feature)"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",children:"// Represented as a Solidity custom error with no parameters\n#[ink::error]\nstruct UnitError;\n\n// Represented as a Solidity custom error with parameters\n#[ink::error]\nstruct ErrorWithParams(bool, u8, String);\n\n// Represented as a Solidity custom error with named parameters\n#[ink::error]\nstruct ErrorWithNamedParams {\n    status: bool,\n    count: u8,\n    reason: String,\n}\n\n// Represented as multiple Solidity custom errors\n// (i.e. each variant represents a Solidity custom error)\n#[ink::error]\nenum MultipleErrors {\n    UnitError,\n    ErrorWithParams(bool, u8, String),\n    ErrorWithNamedParams {\n        status: bool,\n        count: u8,\n        reason: String,\n    }\n}\n"})}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["In ",(0,r.jsx)(n.a,{href:"/docs/v6/basics/abi#declaring-the-abi",children:'"ink" and "all" ABI mode'}),", the ",(0,r.jsx)(n.a,{href:"/docs/v6/macros-attributes/error",children:(0,r.jsx)(n.code,{children:"#[ink::error]"})})," attribute macro\nwill also derive implementations of the ",(0,r.jsxs)(n.a,{href:"https://docs.rs/parity-scale-codec/latest/parity_scale_codec",children:[(0,r.jsx)(n.code,{children:"scale::Encode"})," and ",(0,r.jsx)(n.code,{children:"scale::Decode"})]})," traits."]})}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["For other ",(0,r.jsxs)(n.a,{href:"https://docs.soliditylang.org/en/latest/control-structures.html#revert",children:["Solidity ",(0,r.jsx)(n.code,{children:"revert"})]})," error data representations (e.g. legacy revert strings),\nyou can implement ",(0,r.jsx)(n.a,{href:"https://use-ink.github.io/ink/ink/sol/trait.SolErrorEncode.html",children:(0,r.jsx)(n.code,{children:"SolErrorEncode"})})," and ",(0,r.jsx)(n.a,{href:"https://use-ink.github.io/ink/ink/sol/trait.SolErrorDecode.html",children:(0,r.jsx)(n.code,{children:"SolErrorDecode"})}),"\nmanually to match those representations."]})}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["Rust's ",(0,r.jsx)(n.a,{href:"https://doc.rust-lang.org/reference/items/implementations.html#trait-implementation-coherence",children:"coherence/orphan rules"})," mean that you can only implement the\n",(0,r.jsx)(n.code,{children:"SolErrorEncode"})," and ",(0,r.jsx)(n.code,{children:"SolErrorDecode"})," traits for local types."]})}),"\n",(0,r.jsx)(n.h3,{id:"mappings-for-arbitrary-custom-types",children:"Mappings for arbitrary custom types"}),"\n",(0,r.jsxs)(n.p,{children:["For arbitrary custom types, ",(0,r.jsx)(n.code,{children:"Derive"})," macros are provided for automatically generating\nimplementations of ",(0,r.jsx)(n.a,{href:"https://use-ink.github.io/ink/ink/trait.SolEncode.html",children:(0,r.jsx)(n.code,{children:"SolEncode"})})," and ",(0,r.jsx)(n.a,{href:"https://use-ink.github.io/ink/ink/trait.SolDecode.html",children:(0,r.jsx)(n.code,{children:"SolDecode"})})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["For structs where all fields (if any) implement ",(0,r.jsx)(n.code,{children:"SolEncode"})," and ",(0,r.jsx)(n.code,{children:"SolDecode"})," respectively,\nincluding support for generic types"]}),"\n",(0,r.jsxs)(n.li,{children:["For enums where all variants are either ",(0,r.jsx)(n.a,{href:"https://doc.rust-lang.org/reference/items/enumerations.html#r-items.enum.unit-only",children:"unit-only"})," or ",(0,r.jsx)(n.a,{href:"https://doc.rust-lang.org/reference/items/enumerations.html#r-items.enum.fieldless",children:"field-less"}),"\n(see notes below for the rationale for this limitation)"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",children:"use ink_macro::{SolDecode, SolEncode};\n\n#[derive(SolDecode, SolEncode)]\nstruct UnitStruct;\n\n#[derive(SolDecode, SolEncode)]\nstruct TupleStruct(bool, u8, String);\n\n#[derive(SolDecode, SolEncode)]\nstruct FieldStruct {\n    status: bool,\n    count: u8,\n    reason: String,\n}\n\n#[derive(SolDecode, SolEncode)]\nenum SimpleEnum {\n    One,\n    Two,\n    Three,\n}\n\n#[derive(SolDecode, SolEncode)]\nstruct NestedStruct {\n    unit: UnitStruct,\n    tuple: TupleStruct,\n    fields: FieldStruct,\n    enumerate: SimpleEnum,\n}\n\n#[derive(SolDecode, SolEncode)]\nstruct GenericStruct<T> {\n    concrete: u8,\n    generic: T,\n}\n"})}),"\n",(0,r.jsxs)(n.admonition,{type:"note",children:[(0,r.jsxs)(n.p,{children:["Solidity has no ",(0,r.jsx)(n.strong,{children:"semantic"})," equivalent for Rust/ink! enums with fields\n(i.e. ",(0,r.jsx)(n.a,{href:"https://docs.soliditylang.org/en/latest/types.html#enums",children:"Solidity enums"})," can only express the equivalent of Rust ",(0,r.jsx)(n.a,{href:"https://doc.rust-lang.org/reference/items/enumerations.html#r-items.enum.unit-only",children:"unit-only"}),"\nor ",(0,r.jsx)(n.a,{href:"https://doc.rust-lang.org/reference/items/enumerations.html#r-items.enum.fieldless",children:"field-less"})," enums)."]}),(0,r.jsxs)(n.p,{children:['So mapping complex Rust enums (i.e. enums with fields) to "equivalent" Solidity representations\ntypically yields complex structures based on tuples (at ',(0,r.jsx)(n.a,{href:"https://docs.soliditylang.org/en/latest/abi-spec.html#mapping-solidity-to-abi-types",children:"Solidity ABI encoding"})," level)\nand structs (at Solidity language level)."]}),(0,r.jsxs)(n.p,{children:["Because of this, the ",(0,r.jsx)(n.code,{children:"Derive"})," macros for ",(0,r.jsx)(n.code,{children:"SolEncode"})," and ",(0,r.jsx)(n.code,{children:"SolDecode"})," do NOT generate implementations\nfor enums with fields."]}),(0,r.jsxs)(n.p,{children:["However, you can define custom representations for these types by manually implementing\nthe ",(0,r.jsx)(n.a,{href:"https://use-ink.github.io/ink/ink/trait.SolEncode.html",children:(0,r.jsx)(n.code,{children:"SolEncode"})})," and ",(0,r.jsx)(n.a,{href:"https://use-ink.github.io/ink/ink/trait.SolDecode.html",children:(0,r.jsx)(n.code,{children:"SolDecode"})}),"\n(see linked rustdoc for instructions)."]})]}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["Rust's ",(0,r.jsx)(n.a,{href:"https://doc.rust-lang.org/reference/items/implementations.html#trait-implementation-coherence",children:"coherence/orphan rules"})," mean that you can\nonly implement the ",(0,r.jsx)(n.a,{href:"https://use-ink.github.io/ink/ink/trait.SolEncode.html",children:(0,r.jsx)(n.code,{children:"SolEncode"})})," and ",(0,r.jsx)(n.a,{href:"https://use-ink.github.io/ink/ink/trait.SolDecode.html",children:(0,r.jsx)(n.code,{children:"SolDecode"})}),"\ntraits for local types."]})}),"\n",(0,r.jsx)(n.h2,{id:"solidity-tooling",children:"Solidity Tooling"}),"\n",(0,r.jsxs)(n.p,{children:["You can deploy and interact with ",(0,r.jsx)(n.code,{children:"ink!"})," smart contracts using popular Solidity tools like Hardhat and Foundry thanks to the Solidity-compatible ABI output."]}),"\n",(0,r.jsxs)(n.p,{children:["Full Tutorial: ",(0,r.jsx)(n.a,{href:"/tutorials/ethereum-compatibility/overview",children:"Use Solidity Tooling with ink! Contracts"})]})]})}function a(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},99905:(e,n,i)=>{i.d(n,{A:()=>t});const t=i.p+"assets/images/solidity-c214fe3b4dd74e70b39bbb135b78c5db.svg"}}]);