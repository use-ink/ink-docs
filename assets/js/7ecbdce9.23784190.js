"use strict";(self.webpackChunkink_docs=self.webpackChunkink_docs||[]).push([[8677],{27604:(e,t,n)=>{n.d(t,{A:()=>r});n(36672);var i=n(13526);const s={tabItem:"tabItem_QL86"};var l=n(23420);function r({children:e,hidden:t,className:n}){return(0,l.jsx)("div",{role:"tabpanel",className:(0,i.A)(s.tabItem,n),hidden:t,children:e})}},37926:(e,t,n)=>{n.d(t,{A:()=>k});var i=n(36672),s=n(13526),l=n(81178),r=n(85291),a=n(35517),o=n(50959),c=n(53076),d=n(16931);function u(e){return i.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,i.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function h(e){const{values:t,children:n}=e;return(0,i.useMemo)(()=>{const e=t??function(e){return u(e).map(({props:{value:e,label:t,attributes:n,default:i}})=>({value:e,label:t,attributes:n,default:i}))}(n);return function(e){const t=(0,c.XI)(e,(e,t)=>e.value===t.value);if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e},[t,n])}function p({value:e,tabValues:t}){return t.some(t=>t.value===e)}function y({queryString:e=!1,groupId:t}){const n=(0,r.W6)(),s=function({queryString:e=!1,groupId:t}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:e,groupId:t});return[(0,o.aZ)(s),(0,i.useCallback)(e=>{if(!s)return;const t=new URLSearchParams(n.location.search);t.set(s,e),n.replace({...n.location,search:t.toString()})},[s,n])]}function f(e){const{defaultValue:t,queryString:n=!1,groupId:s}=e,l=h(e),[r,o]=(0,i.useState)(()=>function({defaultValue:e,tabValues:t}){if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!p({value:e,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${t.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const n=t.find(e=>e.default)??t[0];if(!n)throw new Error("Unexpected error: 0 tabValues");return n.value}({defaultValue:t,tabValues:l})),[c,u]=y({queryString:n,groupId:s}),[f,m]=function({groupId:e}){const t=function(e){return e?`docusaurus.tab.${e}`:null}(e),[n,s]=(0,d.Dv)(t);return[n,(0,i.useCallback)(e=>{t&&s.set(e)},[t,s])]}({groupId:s}),b=(()=>{const e=c??f;return p({value:e,tabValues:l})?e:null})();(0,a.A)(()=>{b&&o(b)},[b]);return{selectedValue:r,selectValue:(0,i.useCallback)(e=>{if(!p({value:e,tabValues:l}))throw new Error(`Can't select invalid tab value=${e}`);o(e),u(e),m(e)},[u,m,l]),tabValues:l}}var m=n(47167);const b={tabList:"tabList_dvOz",tabItem:"tabItem_CbXe"};var x=n(23420);function g({className:e,block:t,selectedValue:n,selectValue:i,tabValues:r}){const a=[],{blockElementScrollPositionUntilNextRender:o}=(0,l.a_)(),c=e=>{const t=e.currentTarget,s=a.indexOf(t),l=r[s].value;l!==n&&(o(t),i(l))},d=e=>{let t=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const n=a.indexOf(e.currentTarget)+1;t=a[n]??a[0];break}case"ArrowLeft":{const n=a.indexOf(e.currentTarget)-1;t=a[n]??a[a.length-1];break}}t?.focus()};return(0,x.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.A)("tabs",{"tabs--block":t},e),children:r.map(({value:e,label:t,attributes:i})=>(0,x.jsx)("li",{role:"tab",tabIndex:n===e?0:-1,"aria-selected":n===e,ref:e=>{a.push(e)},onKeyDown:d,onClick:c,...i,className:(0,s.A)("tabs__item",b.tabItem,i?.className,{"tabs__item--active":n===e}),children:t??e},e))})}function j({lazy:e,children:t,selectedValue:n}){const l=(Array.isArray(t)?t:[t]).filter(Boolean);if(e){const e=l.find(e=>e.props.value===n);return e?(0,i.cloneElement)(e,{className:(0,s.A)("margin-top--md",e.props.className)}):null}return(0,x.jsx)("div",{className:"margin-top--md",children:l.map((e,t)=>(0,i.cloneElement)(e,{key:t,hidden:e.props.value!==n}))})}function v(e){const t=f(e);return(0,x.jsxs)("div",{className:(0,s.A)("tabs-container",b.tabList),children:[(0,x.jsx)(g,{...t,...e}),(0,x.jsx)(j,{...t,...e})]})}function k(e){const t=(0,m.A)();return(0,x.jsx)(v,{...e,children:u(e.children)},String(t))}},39841:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>c,default:()=>p,frontMatter:()=>o,metadata:()=>i,toc:()=>u});const i=JSON.parse('{"id":"solidity-interop/use-ink-with-solidity-abi","title":"Use ink! with Solidity ABI","description":"Use Solidity tooling","source":"@site/docs/solidity-interop/use-ink-with-solidity-abi.md","sourceDirName":"solidity-interop","slug":"/solidity-interop/use-ink-with-solidity-abi","permalink":"/docs/v6/solidity-interop/use-ink-with-solidity-abi","draft":false,"unlisted":false,"editUrl":"https://github.com/use-ink/ink-docs/edit/master/docs/solidity-interop/use-ink-with-solidity-abi.md","tags":[],"version":"current","frontMatter":{"title":"Use ink! with Solidity ABI","hide_title":true,"slug":"/solidity-interop/use-ink-with-solidity-abi"},"sidebar":"reference","previous":{"title":"Calling Solidity Contracts","permalink":"/docs/v6/solidity-interop/calling-solidity-contracts"},"next":{"title":"MetaMask Setup","permalink":"/docs/v6/solidity-interop/metamask-setup"}}');var s=n(23420),l=n(65404),r=n(37926),a=n(27604);const o={title:"Use ink! with Solidity ABI",hide_title:!0,slug:"/solidity-interop/use-ink-with-solidity-abi"},c="Use ink! with Solidity ABI",d={},u=[{value:"Why Use Solidity ABI?",id:"why-use-solidity-abi",level:2},{value:"Quick Start",id:"quick-start",level:2},{value:"1. Create Your Contract",id:"1-create-your-contract",level:3},{value:"2. Enable Solidity ABI",id:"2-enable-solidity-abi",level:3},{value:"3. Build with Solidity Metadata",id:"3-build-with-solidity-metadata",level:3},{value:"How It Works",id:"how-it-works",level:2},{value:"Function Selectors",id:"function-selectors",level:3},{value:"Encoding/Decoding",id:"encodingdecoding",level:3},{value:"Constraints",id:"constraints",level:3},{value:"Dual ABI Mode (&quot;all&quot;)",id:"dual-abi-mode-all",level:2},{value:"Benefits",id:"benefits",level:3},{value:"Constraints",id:"constraints-1",level:3},{value:"Tradeoffs",id:"tradeoffs",level:3},{value:"Next Steps",id:"next-steps",level:2}];function h(e){const t={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"Use Solidity tooling",src:n(99905).A+"",width:"1600",height:"500"})}),"\n",(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"use-ink-with-solidity-abi",children:"Use ink! with Solidity ABI"})}),"\n",(0,s.jsx)(t.p,{children:"ink! v6 contracts can be configured to use Solidity ABI encoding,\nenabling seamless compatibility with Ethereum tools like MetaMask, Hardhat, Wagmi, and ethers.js.\nThis allows you to leverage the Ethereum ecosystem while building on Polkadot networks."}),"\n",(0,s.jsx)(t.h2,{id:"why-use-solidity-abi",children:"Why Use Solidity ABI?"}),"\n",(0,s.jsx)(t.p,{children:"By enabling Solidity ABI compatibility, you can:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Use Ethereum wallets"})," like MetaMask to interact with your ink! contracts"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Deploy with Hardhat"})," and other familiar Ethereum development tools"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Build frontends"})," using ethers.js, Wagmi, and other Ethereum frontend libraries"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Share contracts"})," easily with Solidity developers\n(Solidity contracts can call your ink! contract as if it was a Solidity contract)"]}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"quick-start",children:"Quick Start"}),"\n",(0,s.jsx)(t.h3,{id:"1-create-your-contract",children:"1. Create Your Contract"}),"\n",(0,s.jsxs)(r.A,{children:[(0,s.jsx)(a.A,{value:"pop",label:"Pop",default:!0,children:(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"pop new contract my_contract -t standard\ncd my_contract\n"})})}),(0,s.jsx)(a.A,{value:"cargo-contract",label:"cargo-contract",children:(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"cargo contract new --abi sol my_contract\ncd my_contract\n"})})})]}),"\n",(0,s.jsx)(t.h3,{id:"2-enable-solidity-abi",children:"2. Enable Solidity ABI"}),"\n",(0,s.jsxs)(t.p,{children:["Open ",(0,s.jsx)(t.code,{children:"Cargo.toml"}),", add the ",(0,s.jsx)(t.code,{children:"ink-lang"})," table under ",(0,s.jsx)(t.code,{children:"[package.metadata]"}),", and configure the ABI mode:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-toml",children:'[package.metadata.ink-lang]\nabi = "sol"\n'})}),"\n",(0,s.jsxs)(t.p,{children:["Setting ",(0,s.jsx)(t.code,{children:'abi = "sol"'})," puts the contract into Solidity ABI compatibility mode,\nso all constructor, message, event and error types must mappable to Solidity ABI types.\nSee the ",(0,s.jsx)(t.a,{href:"/docs/v6/solidity-interop/type-reference",children:"Type Reference"})," for details."]}),"\n",(0,s.jsx)(t.h3,{id:"3-build-with-solidity-metadata",children:"3. Build with Solidity Metadata"}),"\n",(0,s.jsxs)(r.A,{children:[(0,s.jsx)(a.A,{value:"pop",label:"Pop",default:!0,children:(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"pop build --release --metadata solidity\n"})})}),(0,s.jsx)(a.A,{value:"cargo-contract",label:"cargo-contract",children:(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"cargo contract build --release --metadata solidity\n"})})})]}),"\n",(0,s.jsxs)(t.p,{children:["This generates Solidity-compatible artifacts in ",(0,s.jsx)(t.code,{children:"target/ink/"}),":"]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"*.abi"})," - Solidity ABI file for contract interaction"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"*.json"})," - Metadata compatible with Ethereum tooling"]}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"how-it-works",children:"How It Works"}),"\n",(0,s.jsxs)(t.p,{children:["When you specify ",(0,s.jsx)(t.code,{children:'abi = "sol"'}),", the ink! code generator follows the ",(0,s.jsx)(t.a,{href:"https://docs.soliditylang.org/en/latest/abi-spec.html",children:"Solidity ABI specification"}),":"]}),"\n",(0,s.jsx)(t.h3,{id:"function-selectors",children:"Function Selectors"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["Message selectors use ",(0,s.jsx)(t.strong,{children:"keccak256"})," hashing (Ethereum standard)"]}),"\n",(0,s.jsxs)(t.li,{children:["First 4 bytes of ",(0,s.jsx)(t.code,{children:'keccak256("functionName(type1,type2,...)")'})]}),"\n",(0,s.jsxs)(t.li,{children:["Manual selector overrides via ",(0,s.jsx)(t.code,{children:"#[ink(selector = ...)]"})," are ignored"]}),"\n"]}),"\n",(0,s.jsx)(t.h3,{id:"encodingdecoding",children:"Encoding/Decoding"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["Uses ",(0,s.jsx)(t.a,{href:"https://docs.soliditylang.org/en/latest/abi-spec.html#formal-specification-of-the-encoding",children:"Solidity ABI encoding"})," for inputs/outputs"]}),"\n",(0,s.jsx)(t.li,{children:"Events and errors follow Solidity format"}),"\n",(0,s.jsx)(t.li,{children:"Internal storage still uses SCALE codec (no storage changes!)"}),"\n"]}),"\n",(0,s.jsx)(t.h3,{id:"constraints",children:"Constraints"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Only one constructor"})," can be defined"]}),"\n",(0,s.jsxs)(t.li,{children:["All constructor, message, event and error types must map to Solidity ABI types (see ",(0,s.jsx)(t.a,{href:"/docs/v6/solidity-interop/type-reference",children:"Type Reference"}),")"]}),"\n",(0,s.jsx)(t.li,{children:"Call builders are generated for Solidity calling conventions"}),"\n"]}),"\n",(0,s.jsx)(t.admonition,{title:"Storage Format",type:"info",children:(0,s.jsxs)(t.p,{children:["The contract ABI only affects external interactions. ",(0,s.jsx)(t.strong,{children:"Your contract's internal storage remains SCALE-encoded!"})," Using Solidity ABI does not change your storage layout."]})}),"\n",(0,s.jsx)(t.h2,{id:"dual-abi-mode-all",children:'Dual ABI Mode ("all")'}),"\n",(0,s.jsxs)(t.p,{children:["You can support ",(0,s.jsx)(t.strong,{children:"both"})," ink! and Solidity ABIs simultaneously:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-toml",children:'[package.metadata.ink-lang]\nabi = "all"\n'})}),"\n",(0,s.jsx)(t.h3,{id:"benefits",children:"Benefits"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Contracts callable by both ink! and Solidity tools"}),"\n",(0,s.jsx)(t.li,{children:"Each message has two entry points (ink! selector + Solidity selector)"}),"\n",(0,s.jsx)(t.li,{children:"Flexibility for cross-ecosystem interoperability"}),"\n"]}),"\n",(0,s.jsx)(t.h3,{id:"constraints-1",children:"Constraints"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["All constructor, message, event and error types must map to Solidity ABI types (see ",(0,s.jsx)(t.a,{href:"/docs/v6/solidity-interop/type-reference",children:"Type Reference"}),")"]}),"\n",(0,s.jsxs)(t.li,{children:["Must designate a ",(0,s.jsx)(t.code,{children:"#[ink(constructor, default)]"})," for Solidity instantiation (if more than one constructor is defined)"]}),"\n"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-rust",children:"#[ink(constructor, default)]\npub fn new(initial_value: bool) -> Self {\n    Self { value: initial_value }\n}\n"})}),"\n",(0,s.jsx)(t.h3,{id:"tradeoffs",children:"Tradeoffs"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Larger contract size"})," (entry points for both ink! and Solidity ABI selectors compiled in)"]}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,s.jsx)(t.p,{children:"Now that your contract is Solidity ABI compatible:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.a,{href:"/docs/v6/solidity-interop/calling-solidity-contracts",children:"Call Solidity Contracts"})," from ink!"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.a,{href:"/docs/v6/solidity-interop/metamask-setup",children:"Set up MetaMask"})," and other Ethereum tools"]}),"\n",(0,s.jsxs)(t.li,{children:["Check ",(0,s.jsx)(t.a,{href:"/docs/v6/solidity-interop/type-reference",children:"Type Reference"})," for advanced type mappings"]}),"\n"]})]})}function p(e={}){const{wrapper:t}={...(0,l.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},65404:(e,t,n)=>{n.d(t,{R:()=>r,x:()=>a});var i=n(36672);const s={},l=i.createContext(s);function r(e){const t=i.useContext(l);return i.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),i.createElement(l.Provider,{value:t},e.children)}},99905:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/solidity-c214fe3b4dd74e70b39bbb135b78c5db.svg"}}]);