"use strict";(self.webpackChunkink_docs=self.webpackChunkink_docs||[]).push([[8294],{2385:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/metadata-revive-2409587c8d292f13afb31073948c3ec6.svg"},6530:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"reference/abi/all","title":"\\"All\\" ABI Mode\\n","description":"Metadata Title Picture","source":"@site/docs/reference/abi/all.md","sourceDirName":"reference/abi","slug":"/basics/abi/all","permalink":"/docs/v6/basics/abi/all","draft":false,"unlisted":false,"editUrl":"https://github.com/use-ink/ink-docs/edit/master/docs/reference/abi/all.md","tags":[],"version":"current","frontMatter":{"title":"\\"All\\" ABI Mode\\n","hide_title":true,"slug":"/basics/abi/all"},"sidebar":"reference","previous":{"title":"Solidity ABI","permalink":"/docs/v6/basics/abi/solidity"},"next":{"title":"Overview","permalink":"/docs/v6/basics/metadata"}}');var s=t(23420),o=t(65404);const r={title:'"All" ABI Mode\n',hide_title:!0,slug:"/basics/abi/all"},c='"All" ABI Mode',a={},l=[{value:"Solidity ABI Mode",id:"solidity-abi-mode",level:3}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h3:"h3",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Metadata Title Picture",src:t(2385).A+"",width:"1600",height:"500"})}),"\n",(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"all-abi-mode",children:'"All" ABI Mode'})}),"\n",(0,s.jsxs)(n.p,{children:['The "all" ABI mode is declared in the contract\'s manifest file (i.e. the ',(0,s.jsx)(n.code,{children:"Cargo.toml"})," file)\nas follows:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-toml",children:'[package.metadata.ink-lang]\nabi = "all"\n'})}),"\n",(0,s.jsx)(n.p,{children:'When the "all" ABI is specified, the ink! code generator follows both\nthe ink! and Solidity ABI specifications, and generates entry points\nfor both calling conventions. This means:'}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["For each message, two selectors are generated, one for ",(0,s.jsx)(n.a,{href:"/docs/v6/basics/abi/ink",children:"ink!"}),"\nand another for ",(0,s.jsx)(n.a,{href:"/docs/v6/basics/abi/solidity",children:"Solidity"})," ABI."]}),"\n",(0,s.jsxs)(n.li,{children:["Each selector is ABI specific and its entry point uses the corresponding\ninput/output encoding/decoding scheme (i.e. entry points for ink! selectors use\nParity's ",(0,s.jsx)(n.a,{href:"https://docs.rs/parity-scale-codec/latest/parity_scale_codec",children:"SCALE Codec"}),", while entry points for Solidity selectors\nuse Solidity ABI encoding/decoding for input/output encoding/decoding)."]}),"\n",(0,s.jsxs)(n.li,{children:["Message selector manual overrides\n(using the ",(0,s.jsxs)(n.a,{href:"/docs/v6/macros-attributes/selector",children:[(0,s.jsx)(n.code,{children:"selector"})," attribute"]}),") are respected for\nink! ABI entry points but ignored for Solidity ABI entry points\n(i.e. Solidity selectors are ",(0,s.jsx)(n.strong,{children:"always"})," generated according to the\n",(0,s.jsx)(n.a,{href:"https://docs.soliditylang.org/en/latest/abi-spec.html#function-selector",children:"Solidity ABI specification for function selectors"}),")."]}),"\n",(0,s.jsxs)(n.li,{children:["Multiple constructors are supported (as per the ink! ABI), however,\nif multiple constructors are defined, then one of the constructors\nmust be annotated with the ",(0,s.jsxs)(n.a,{href:"/docs/v6/macros-attributes/default",children:[(0,s.jsx)(n.code,{children:"default"})," attribute"]}),"\nto identify it as the constructor to use for Solidity ABI encoded instantiation.\nNote that if only a single constructor is defined,\nthen the ",(0,s.jsx)(n.code,{children:"default"})," attribute annotation is unnecessary."]}),"\n",(0,s.jsxs)(n.li,{children:["Call builders and ",(0,s.jsx)(n.a,{href:"/docs/v6/basics/cross-contract-calling#contract-references",children:"contract references"})," are generated for\nboth ink! and Solidity ABI calling conventions."]}),"\n",(0,s.jsxs)(n.li,{children:["Both an ink! and Solidity ABI encoded event are emitted for each call to\n",(0,s.jsx)(n.code,{children:"Self::env().emit_event()"})," or ",(0,s.jsx)(n.code,{children:"self.env().emit_event()"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsx)(n.p,{children:"Your contract sizes will get larger if you support both the ink! and Solidity ABI."})}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsxs)(n.p,{children:['The "all" ABI mode can only be used if all message argument and return types,\nthe argument and return type of the constructor used for Solidity ABI encoded instantiation,\nand event argument types can be mapped to equivalent Solidity ABI types\n(',(0,s.jsx)(n.a,{href:"/docs/v6/solidity-interop/type-reference#rustink-to-solidity-abi-type-mapping",children:"more details here"}),")."]})}),"\n",(0,s.jsx)(n.h3,{id:"solidity-abi-mode",children:"Solidity ABI Mode"}),"\n",(0,s.jsxs)(n.p,{children:["In ",(0,s.jsx)(n.a,{href:"/docs/v6/basics/abi/all",children:'"all" ABI mode'}),", contract references are generated for both ink!/native and Solidity ABI calling conventions. The Solidity ABI specific contract reference is named with an additional ",(0,s.jsx)(n.code,{children:"Sol"})," suffix (e.g. ",(0,s.jsx)(n.code,{children:"ContractRefSol"})," for a contract named ",(0,s.jsx)(n.code,{children:"Contract"}),")."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-rust",children:"// Example: Using the Solidity ABI contract reference\nuse other_contract::OtherContractRefSol;\n\n#[ink(storage)]\npub struct MyContract {\n    other_contract: OtherContractRefSol,\n}\n"})}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.p,{children:["In ",(0,s.jsx)(n.a,{href:"/docs/v6/basics/abi/solidity",children:'"sol" ABI mode'}),", the ",(0,s.jsx)(n.code,{children:"Sol"})," suffix is not necessary. For a contract named ",(0,s.jsx)(n.code,{children:"Contract"}),", ",(0,s.jsx)(n.code,{children:"ContractRef"})," will use the Solidity ABI calling conventions directly."]})})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},65404:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>c});var i=t(36672);const s={},o=i.createContext(s);function r(e){const n=i.useContext(o);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);