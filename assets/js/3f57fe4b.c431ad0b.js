"use strict";(self.webpackChunkink_docs=self.webpackChunkink_docs||[]).push([[2576],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>d});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var i=r.createContext({}),c=function(e){var t=r.useContext(i),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},p=function(e){var t=c(e.components);return r.createElement(i.Provider,{value:t},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},f=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,i=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),u=c(n),f=a,d=u["".concat(i,".").concat(f)]||u[f]||m[f]||o;return n?r.createElement(d,s(s({ref:t},p),{},{components:n})):r.createElement(d,s({ref:t},p))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,s=new Array(o);s[0]=f;var l={};for(var i in t)hasOwnProperty.call(t,i)&&(l[i]=t[i]);l.originalType=e,l[u]="string"==typeof e?e:a,s[1]=l;for(var c=2;c<o;c++)s[c]=n[c];return r.createElement.apply(null,s)}return r.createElement.apply(null,n)}f.displayName="MDXCreateElement"},5802:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>i,contentTitle:()=>s,default:()=>u,frontMatter:()=>o,metadata:()=>l,toc:()=>c});var r=n(7462),a=(n(7294),n(3905));const o={title:"#[ink(selector = S:u32)]",slug:"/macros-attributes/selector"},s=void 0,l={unversionedId:"macros-attributes/selector",id:"macros-attributes/selector",title:"#[ink(selector = S:u32)]",description:"Applicable to ink! messages and ink! constructors.",source:"@site/docs/macros-attributes/selector.md",sourceDirName:"macros-attributes",slug:"/macros-attributes/selector",permalink:"/4.x/macros-attributes/selector",draft:!1,editUrl:"https://github.com/paritytech/ink-docs/edit/master/docs/macros-attributes/selector.md",tags:[],version:"current",frontMatter:{title:"#[ink(selector = S:u32)]",slug:"/macros-attributes/selector"},sidebar:"reference",previous:{title:"#[ink(payable)]",permalink:"/4.x/macros-attributes/payable"},next:{title:"#[ink(storage)]",permalink:"/4.x/macros-attributes/storage"}},i={},c=[{value:"Examples",id:"examples",level:2},{value:"Controlling the messages selector",id:"controlling-the-messages-selector",level:2}],p={toc:c};function u(e){let{components:t,...n}=e;return(0,a.kt)("wrapper",(0,r.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"Applicable to ink! messages and ink! constructors."),(0,a.kt)("p",null,"By default ink! creates a selector for each message and constructor.\nThis is necessary since the contract is compiled to a Wasm blob and functions are invoked by invoking the\nselector, which identifies a method \u2012 method names are no longer available in these underlying layers."),(0,a.kt)("p",null,"Using this attribute it is possible to speficy a concrete dispatch selector for the flagged entity. This allows a contract author to precisely control the selectors of their APIs making it possible to rename their API without breakage."),(0,a.kt)("p",null,"A selector must be a ",(0,a.kt)("inlineCode",{parentName:"p"},"u32")," decodable integer. For example"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"selector = 0xCAFEBABE")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"selector = 42"))),(0,a.kt)("p",null,"An exception is the fallback selector ",(0,a.kt)("inlineCode",{parentName:"p"},"_"),", allowing contract calls not matching any of the other message selectors to be dispatched to a fallback message. Fallback messages can be ",(0,a.kt)("inlineCode",{parentName:"p"},"payable"),"."),(0,a.kt)("h2",{id:"examples"},"Examples"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-rust"},"#[ink(message, selector = 0xC0DECAFE)]\nfn my_message_1(&self) {}\n\n#[ink(message, selector = 42)]\nfn my_message_2(&self) {}\n\n#[ink(message, payable, selector = _)]\nfn my_fallback(&self) {}\n")),(0,a.kt)("p",null,"\u2026 then the selector of ",(0,a.kt)("inlineCode",{parentName:"p"},"my_message_1")," is ",(0,a.kt)("inlineCode",{parentName:"p"},"[0xC0, 0xDE, 0xCA, 0xFE]")," and the selector of ",(0,a.kt)("inlineCode",{parentName:"p"},"my_message_2")," is ",(0,a.kt)("inlineCode",{parentName:"p"},"[0, 0, 0, 42]"),"\nsince setting the selector manually overrides the automatically generated selector."),(0,a.kt)("h2",{id:"controlling-the-messages-selector"},"Controlling the messages selector"),(0,a.kt)("p",null,"Every ink! message and ink! constructor has a selector with which the\nmessage or constructor can be uniquely identified within the ink! smart contract.\nNon-unique message or constructor selector lead to a compile time error.\nThese selectors are mainly used to drive the contract's dispatch upon calling it."),(0,a.kt)("p",null,"An ink! smart contract author can control the selector of an ink! message or ink!\nconstructor using the ",(0,a.kt)("inlineCode",{parentName:"p"},"selector")," flag. An example is shown below:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-rust"},"#[ink::contract]\nmod flipper {\n    #[ink(storage)]\n    pub struct Flipper {\n        value: bool,\n    }\n\n    impl Flipper {\n        #[ink(constructor)]\n        #[ink(selector = 0xDEADBEEF)] // Works on constructors as well.\n        pub fn new(initial_value: bool) -> Self {\n            Flipper { value: initial_value }\n        }\n\n        #[ink(message)]\n        #[ink(selector = 0xCAFEBABE)] // You can either specify selector out-of-line.\n        pub fn flip(&mut self) {\n            self.value = !self.value;\n        }\n        \n        #[ink(message, selector = 0xC0DECAFE)] // ...or specify the selector inline.\n        pub fn get(&self) -> bool {\n            self.value\n        }\n    }\n}\n")))}u.isMDXComponent=!0}}]);