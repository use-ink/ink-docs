"use strict";(self.webpackChunkink_docs=self.webpackChunkink_docs||[]).push([[3769],{22890:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"faq/migrating-from-ink-5-to-6","title":"Migrate from ink! v5 \u2192 v6","description":"We\'ve made a couple of breaking changes from ink! 5.x to ink! 6.0.","source":"@site/versioned_docs/version-6.x/faq/migrating-from-ink-5-to-6.md","sourceDirName":"faq","slug":"/faq/migrating-from-ink-5-to-6","permalink":"/6.x/faq/migrating-from-ink-5-to-6","draft":false,"unlisted":false,"editUrl":"https://github.com/use-ink/ink-docs/edit/master/versioned_docs/version-6.x/faq/migrating-from-ink-5-to-6.md","tags":[],"version":"6.x","frontMatter":{"title":"Migrate from ink! v5 \u2192 v6","slug":"/faq/migrating-from-ink-5-to-6"},"sidebar":"reference","previous":{"title":"Project State in Q1/25","permalink":"/6.x/current-state"},"next":{"title":"Why Rust for Smart Contracts?","permalink":"/6.x/why-rust-for-smart-contracts"}}');var o=i(74848),s=i(28453);const r={title:"Migrate from ink! v5 \u2192 v6",slug:"/faq/migrating-from-ink-5-to-6"},a=void 0,c={},l=[{value:"How to upgrade",id:"how-to-upgrade",level:2},{value:"Compatibility",id:"compatibility",level:2},{value:"How do I find out if a chain is compatible with ink! 5?",id:"how-do-i-find-out-if-a-chain-is-compatible-with-ink-5",level:3},{value:"<code>cargo-contract</code> 6.0",id:"cargo-contract-60",level:3},{value:"Tooling &amp; Libraries",id:"tooling--libraries",level:3},{value:"Important Changes",id:"important-changes",level:2},{value:"Restrict which <code>cfg</code> attributes can be used",id:"restrict-which-cfg-attributes-can-be-used",level:3},{value:"Interesting New Features",id:"interesting-new-features",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("img",{src:"/img/title/migration-5.x-to-6.0.svg",className:"titlePic"}),"\n",(0,o.jsx)(n.p,{children:"We've made a couple of breaking changes from ink! 5.x to ink! 6.0.\nOn this page we outline how you can migrate existing dApps and\ncontracts."}),"\n",(0,o.jsxs)(n.p,{children:["You can find the full changelog of the 6.0 release ",(0,o.jsx)(n.a,{href:"https://github.com/use-ink/ink/blob/master/CHANGELOG.md#version-600",children:"here"}),"."]}),"\n",(0,o.jsxs)(n.admonition,{type:"caution",children:[(0,o.jsx)(n.p,{children:"This migration guide only considers your code base! Not your storage data!"}),(0,o.jsx)(n.p,{children:"If you have an existing contract on-chain you might not be able to just\nupgrade the code on-chain, you possibly also have to migrate your storage data."})]}),"\n",(0,o.jsx)(n.h2,{id:"how-to-upgrade",children:"How to upgrade"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Change the dependency versions of ",(0,o.jsx)(n.code,{children:"ink"})," and ",(0,o.jsx)(n.code,{children:"ink_e2e"})," in your contracts ",(0,o.jsx)(n.code,{children:"Cargo.toml"})," to ",(0,o.jsx)(n.code,{children:"6"}),"."]}),"\n",(0,o.jsxs)(n.li,{children:["Update your local ",(0,o.jsx)(n.code,{children:"cargo-contract"})," installation to 6.0."]}),"\n",(0,o.jsx)(n.li,{children:"Read through this page."}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"compatibility",children:"Compatibility"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.code,{children:">= polkadot-v1.9.0"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.code,{children:"pallet-contracts >= polkadot-v0.9.37"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.code,{children:"substrate-contracts-node >= v0.24.0"})}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"how-do-i-find-out-if-a-chain-is-compatible-with-ink-5",children:"How do I find out if a chain is compatible with ink! 5?"}),"\n",(0,o.jsxs)(n.p,{children:["You can query ",(0,o.jsx)(n.code,{children:"contracts::palletVersion()"})," via the chain state RPCs. It has to\nbe ",(0,o.jsx)(n.code,{children:">= 9"})," for ink! 5.0 to be compatible, if you don't use any of the four functions\nmentioned above.\nFor the above mentioned four functions please see the respective sections on this page,\nthere we explain how to find out if a chain supports them there."]}),"\n",(0,o.jsxs)(n.p,{children:["You can use the ",(0,o.jsx)(n.a,{href:"https://polkadot.js.org/apps/",children:"polakdot.js app"})," to connect to the chain and check if\n",(0,o.jsx)(n.code,{children:"reviveApi"})," is available under Developer \xbb Runtime calls."]}),"\n",(0,o.jsx)("img",{src:"/img/pallet-revive-available.png"}),"\n",(0,o.jsx)(n.p,{children:"The following chains are in production and support ink! 6.0."}),"\n",(0,o.jsxs)("div",{className:"row",children:[(0,o.jsx)("div",{className:"col text--center",children:(0,o.jsx)("a",{href:"https://onpop.io",children:(0,o.jsx)("img",{src:"/img/chains/polkadot-pop-network.svg",className:"chain"})})}),(0,o.jsx)("div",{className:"col text--center",children:(0,o.jsx)("a",{href:"https://kusama.network/",children:(0,o.jsx)("img",{src:"/img/chains/kusama-assethub.svg",className:"chain"})})})]}),"\n",(0,o.jsxs)(n.h3,{id:"cargo-contract-60",children:[(0,o.jsx)(n.code,{children:"cargo-contract"})," 6.0"]}),"\n",(0,o.jsxs)(n.p,{children:["Together with ink! 6.0 we've released ",(0,o.jsx)(n.code,{children:"cargo-contract"})," 6.0.\nYou have to use ",(0,o.jsx)(n.code,{children:"cargo-contract"})," >= 6.0 for ink! 6.0 contracts!"]}),"\n",(0,o.jsx)(n.p,{children:"You can upgrade via:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-rust",children:"cargo install cargo-contract --version ^6\n"})}),"\n",(0,o.jsx)(n.h3,{id:"tooling--libraries",children:"Tooling & Libraries"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Stable Rust >= 1.81"}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"cargo-contract"})," >= v6.0"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"polkadot-js/api"})," and ",(0,o.jsx)(n.code,{children:"polkadot-js/api-contract"})," >= 10.12.1"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.a,{href:"https://github.com/scio-labs/use-inkathon",children:(0,o.jsx)(n.code,{children:"use-inkathon"})}),": 10.12.1"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.a,{href:"https://inkathon.xyz/",children:"ink!athon"})," >= 0.7.0"]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"important-changes",children:"Important Changes"}),"\n",(0,o.jsx)(n.p,{children:"We had to introduce a number of changes that require you to manually upgrade\nyour contract from 5.x to 6.0. The steps to do this are explained in this section."}),"\n",(0,o.jsxs)(n.h3,{id:"restrict-which-cfg-attributes-can-be-used",children:["Restrict which ",(0,o.jsx)(n.code,{children:"cfg"})," attributes can be used"]}),"\n",(0,o.jsxs)(n.p,{children:["This change was done as a recommendation from the ink! 5.x audit.\nIn a nutshell it prevents developers from hiding functionality in a contract,\nthat would not be visible in the metadata (so e.g. on a block explorer).\nThe relevant PR is ",(0,o.jsx)(n.a,{href:"https://github.com/use-ink/ink/pull/2313",children:"#2313"}),"."]}),"\n",(0,o.jsxs)(n.p,{children:["From ink! 6.0 on only these attributes are allowed in ",(0,o.jsx)(n.code,{children:"#[cfg(\u2026)]"}),":"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.code,{children:"test"})}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"feature"})," (without ",(0,o.jsx)(n.code,{children:"std"}),")"]}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.code,{children:"any"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.code,{children:"not"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.code,{children:"all"})}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"interesting-new-features",children:"Interesting New Features"})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>a});var t=i(96540);const o={},s=t.createContext(o);function r(e){const n=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);