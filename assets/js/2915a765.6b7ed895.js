"use strict";(self.webpackChunkink_docs=self.webpackChunkink_docs||[]).push([[2693],{27604:(e,t,n)=>{n.d(t,{A:()=>o});n(36672);var a=n(13526);const r={tabItem:"tabItem_QL86"};var s=n(23420);function o({children:e,hidden:t,className:n}){return(0,s.jsx)("div",{role:"tabpanel",className:(0,a.A)(r.tabItem,n),hidden:t,children:e})}},37926:(e,t,n)=>{n.d(t,{A:()=>w});var a=n(36672),r=n(13526),s=n(81178),o=n(85291),i=n(35517),l=n(50959),c=n(53076),u=n(16931);function d(e){return a.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,a.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function h(e){const{values:t,children:n}=e;return(0,a.useMemo)(()=>{const e=t??function(e){return d(e).map(({props:{value:e,label:t,attributes:n,default:a}})=>({value:e,label:t,attributes:n,default:a}))}(n);return function(e){const t=(0,c.XI)(e,(e,t)=>e.value===t.value);if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e},[t,n])}function p({value:e,tabValues:t}){return t.some(t=>t.value===e)}function f({queryString:e=!1,groupId:t}){const n=(0,o.W6)(),r=function({queryString:e=!1,groupId:t}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:e,groupId:t});return[(0,l.aZ)(r),(0,a.useCallback)(e=>{if(!r)return;const t=new URLSearchParams(n.location.search);t.set(r,e),n.replace({...n.location,search:t.toString()})},[r,n])]}function b(e){const{defaultValue:t,queryString:n=!1,groupId:r}=e,s=h(e),[o,l]=(0,a.useState)(()=>function({defaultValue:e,tabValues:t}){if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!p({value:e,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${t.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const n=t.find(e=>e.default)??t[0];if(!n)throw new Error("Unexpected error: 0 tabValues");return n.value}({defaultValue:t,tabValues:s})),[c,d]=f({queryString:n,groupId:r}),[b,m]=function({groupId:e}){const t=function(e){return e?`docusaurus.tab.${e}`:null}(e),[n,r]=(0,u.Dv)(t);return[n,(0,a.useCallback)(e=>{t&&r.set(e)},[t,r])]}({groupId:r}),g=(()=>{const e=c??b;return p({value:e,tabValues:s})?e:null})();(0,i.A)(()=>{g&&l(g)},[g]);return{selectedValue:o,selectValue:(0,a.useCallback)(e=>{if(!p({value:e,tabValues:s}))throw new Error(`Can't select invalid tab value=${e}`);l(e),d(e),m(e)},[d,m,s]),tabValues:s}}var m=n(47167);const g={tabList:"tabList_dvOz",tabItem:"tabItem_CbXe"};var v=n(23420);function x({className:e,block:t,selectedValue:n,selectValue:a,tabValues:o}){const i=[],{blockElementScrollPositionUntilNextRender:l}=(0,s.a_)(),c=e=>{const t=e.currentTarget,r=i.indexOf(t),s=o[r].value;s!==n&&(l(t),a(s))},u=e=>{let t=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const n=i.indexOf(e.currentTarget)+1;t=i[n]??i[0];break}case"ArrowLeft":{const n=i.indexOf(e.currentTarget)-1;t=i[n]??i[i.length-1];break}}t?.focus()};return(0,v.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.A)("tabs",{"tabs--block":t},e),children:o.map(({value:e,label:t,attributes:a})=>(0,v.jsx)("li",{role:"tab",tabIndex:n===e?0:-1,"aria-selected":n===e,ref:e=>{i.push(e)},onKeyDown:u,onClick:c,...a,className:(0,r.A)("tabs__item",g.tabItem,a?.className,{"tabs__item--active":n===e}),children:t??e},e))})}function y({lazy:e,children:t,selectedValue:n}){const s=(Array.isArray(t)?t:[t]).filter(Boolean);if(e){const e=s.find(e=>e.props.value===n);return e?(0,a.cloneElement)(e,{className:(0,r.A)("margin-top--md",e.props.className)}):null}return(0,v.jsx)("div",{className:"margin-top--md",children:s.map((e,t)=>(0,a.cloneElement)(e,{key:t,hidden:e.props.value!==n}))})}function k(e){const t=b(e);return(0,v.jsxs)("div",{className:(0,r.A)("tabs-container",g.tabList),children:[(0,v.jsx)(x,{...t,...e}),(0,v.jsx)(y,{...t,...e})]})}function w(e){const t=(0,m.A)();return(0,v.jsx)(k,{...e,children:d(e.children)},String(t))}},41183:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/images/testing1-d84c1e06aff43cd5541920ef31eee08f.svg"},57023:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>u,contentTitle:()=>c,default:()=>p,frontMatter:()=>l,metadata:()=>a,toc:()=>d});const a=JSON.parse('{"id":"testing/e2e","title":"Full E2E","description":"Testing1 Title Picture","source":"@site/docs/testing/e2e.md","sourceDirName":"testing","slug":"/contract-testing/end-to-end-e2e-testing","permalink":"/docs/v6/contract-testing/end-to-end-e2e-testing","draft":false,"unlisted":false,"editUrl":"https://github.com/use-ink/ink-docs/edit/master/docs/testing/e2e.md","tags":[],"version":"current","frontMatter":{"title":"Full E2E","hide_title":true,"slug":"/contract-testing/end-to-end-e2e-testing"},"sidebar":"reference","previous":{"title":"Sandboxed E2E","permalink":"/docs/v6/contract-testing/drink"},"next":{"title":"Overview","permalink":"/docs/v6/contract-debugging/"}}');var r=n(23420),s=n(65404),o=n(37926),i=n(27604);const l={title:"Full E2E",hide_title:!0,slug:"/contract-testing/end-to-end-e2e-testing"},c="End-to-End (E2E) Tests",u={},d=[{value:"Example",id:"example",level:2}];function h(e){const t={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",img:"img",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{alt:"Testing1 Title Picture",src:n(41183).A+"",width:"1600",height:"500"})}),"\n",(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"end-to-end-e2e-tests",children:"End-to-End (E2E) Tests"})}),"\n",(0,r.jsxs)(t.p,{children:["E2E testing enables developers to write a test that will not only test the contract in an\nisolated manner; instead the contract will be tested ",(0,r.jsx)(t.em,{children:"together"})," with all components that\nwill be involved on-chain \u2013 so from end to end. This way of testing resembles closely\nhow the contract will actually behave in production."]}),"\n",(0,r.jsx)(t.p,{children:"As part of the test, the contract will be compiled and deployed to a Polkadot SDK node that\nis running in the background. ink! offers API functions that enable developers to then\ninteract with the contract via transactions that they create and submit to the blockchain."}),"\n",(0,r.jsx)(t.p,{children:"You as a developer can define assertions on the outcome of their transactions, such as checking\nfor state mutations, transaction failures or incurred gas costs."}),"\n",(0,r.jsx)(t.p,{children:"Your chain configuration will be tested together with the smart contract. And if your\nchain has pallets that are involved with the smart contract execution, those will be\npart of the test execution as well."}),"\n",(0,r.jsx)(t.p,{children:"ink! does not put any requirements on the Polkadot SDK node in the background \u2013 for example,\nyou can run a node that contains a snapshot of a live network."}),"\n",(0,r.jsx)(t.h2,{id:"example",children:"Example"}),"\n",(0,r.jsxs)(t.p,{children:["The following code example illustrates a basic E2E test for the\n",(0,r.jsx)(t.a,{href:"https://github.com/use-ink/ink-examples/blob/main/flipper/lib.rs",children:"flipper example"}),"."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-rust",children:'#[ink_e2e::test]\nasync fn default_works<Client: E2EBackend>(mut client: Client) -> E2EResult<()> {\n    // When the function is entered, the contract was already\n    // built in the background via `cargo contract build`.\n    // The `client` object exposes an interface to interact\n    // with the Polkadot SDK node.\n    \n    // given\n    let mut constructor = FlipperRef::new_default();\n\n    // when\n    let contract = client\n        .instantiate("flipper", &ink_e2e::bob(), &mut constructor)\n        .submit()\n        .await\n        .expect("instantiate failed");\n    let call_builder = contract.call_builder::<Flipper>();\n\n    // then\n    let get = call_builder.get();\n    let get_res = client.call(&ink_e2e::bob(), &get).dry_run().await?;\n    assert!(matches!(get_res.return_value(), false));\n\n    Ok(())\n}\n'})}),"\n",(0,r.jsxs)(t.p,{children:["You can run the above test by going to the ",(0,r.jsx)(t.code,{children:"flipper"})," folder in\n",(0,r.jsx)(t.a,{href:"https://github.com/use-ink/ink-examples/tree/main",children:"the ink! examples directory"}),"."]}),"\n",(0,r.jsxs)(t.p,{children:["Before you can run the test, you have to install a Polkadot SDK\nnode with ",(0,r.jsx)(t.code,{children:"pallet-revive"}),". By default, e2e tests require that you install ",(0,r.jsx)(t.a,{href:"https://github.com/use-ink/ink-node",children:(0,r.jsx)(t.code,{children:"ink-node"})}),". You do not need to run it in the background since the node is started for each test independently.\nThe easiest way is to\n",(0,r.jsx)(t.a,{href:"https://github.com/use-ink/ink-node/releases",children:"download a binary from our releases page"}),"\n(Linux and Mac).\nAlternatively, you can build the node by yourself.\nThe build instructions and pre-requisites can be found\n",(0,r.jsx)(t.a,{href:"https://github.com/use-ink/ink-node?tab=readme-ov-file#build-locally",children:"here"}),"."]}),"\n",(0,r.jsxs)(t.p,{children:["If you want to run any other node with ",(0,r.jsx)(t.code,{children:"pallet-revive"})," you need to change ",(0,r.jsx)(t.code,{children:"CONTRACTS_NODE"})," environment variable:"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:'export CONTRACTS_NODE="YOUR_CONTRACTS_NODE_PATH"\n'})}),"\n",(0,r.jsx)(t.p,{children:"And finally execute the following command to start e2e test execution."}),"\n",(0,r.jsxs)(o.A,{children:[(0,r.jsx)(i.A,{value:"cargo-contract",label:"cargo-contract",default:!0,children:(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"cargo contract test --features e2e-tests\n"})})}),(0,r.jsx)(i.A,{value:"pop",label:"Pop",children:(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"pop test --e2e\n"})})})]})]})}function p(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},65404:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>i});var a=n(36672);const r={},s=a.createContext(r);function o(e){const t=a.useContext(s);return a.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),a.createElement(s.Provider,{value:t},e.children)}}}]);