<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-6.x docs-doc-page docs-doc-id-macros-attributes/chain-extension" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.6.3">
<title data-rh="true">#[ink::chain_extension] | ink! documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://use.ink/6.x/macros-attributes/chain-extension"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="6.x"><meta data-rh="true" name="docusaurus_tag" content="docs-default-6.x"><meta data-rh="true" name="docsearch:version" content="6.x"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-6.x"><meta data-rh="true" property="og:title" content="#[ink::chain_extension] | ink! documentation"><meta data-rh="true" name="description" content="In the default configuration of the contracts-pallet a smart contract can only interact with the runtime"><meta data-rh="true" property="og:description" content="In the default configuration of the contracts-pallet a smart contract can only interact with the runtime"><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://use.ink/6.x/macros-attributes/chain-extension"><link data-rh="true" rel="alternate" href="https://use.ink/6.x/macros-attributes/chain-extension" hreflang="en"><link data-rh="true" rel="alternate" href="https://use.ink/6.x/macros-attributes/chain-extension" hreflang="x-default"><link rel="stylesheet" href="fonts/fonts.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Montserrat:wght@400;500;700&display=swap">
<script src="https://apisa.parity.io/latest.js" defer="defer"></script><link rel="stylesheet" href="/assets/css/styles.f05d0db5.css">
<script src="/assets/js/runtime~main.1d290a35.js" defer="defer"></script>
<script src="/assets/js/main.d120c3a9.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/text-black.svg" alt="ink!" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/text-white.svg" alt="ink!" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item oldVersion"><div class="attention"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M256 32c14.2 0 27.3 7.5 34.5 19.8l216 368c7.3 12.4 7.3 27.7 .2 40.1S486.3 480 472 480H40c-14.3 0-27.6-7.7-34.7-20.1s-7-27.8 .2-40.1l216-368C228.7 39.5 241.8 32 256 32zm0 128c-13.3 0-24 10.7-24 24V296c0 13.3 10.7 24 24 24s24-10.7 24-24V184c0-13.3-10.7-24-24-24zm32 224c0-17.7-14.3-32-32-32s-32 14.3-32 32s14.3 32 32 32s32-14.3 32-32z&quot;"></path></svg></div>You are viewing the documentation for an <em>unreleased</em> version of ink!.</div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/6.x/macros-attributes/chain-extension">6.x</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/macros-attributes/chain-extension">5.x</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/6.x/macros-attributes/chain-extension">6.x</a></li><li><a class="dropdown__link" href="/4.x/macros-attributes/chain-extension">4.x</a></li><li><a class="dropdown__link" href="/3.x/macros-attributes/chain-extension">3.x</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite" aria-pressed="true"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/6.x/">Overview</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/6.x/getting-started/setup">Getting started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/6.x/basics/contract-template">Basics</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/6.x/basics/contract-testing/overview">Testing &amp; Debugging</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/6.x/macros-attributes">Macros &amp; Attributes</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/6.x/macros-attributes">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/6.x/macros-attributes/contract">#[ink::contract]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/6.x/macros-attributes/anonymous">#[ink(anonymous)]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/6.x/macros-attributes/constructor">#[ink(constructor)]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/6.x/macros-attributes/default">#[ink(default)]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/6.x/macros-attributes/event">#[ink::event]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/6.x/macros-attributes/impl">#[ink(impl)]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/6.x/macros-attributes/message">#[ink(message)]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/6.x/macros-attributes/namespace">#[ink(namespace = &quot;…&quot;)]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/6.x/macros-attributes/payable">#[ink(payable)]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/6.x/macros-attributes/selector">#[ink(selector = S:u32)]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/6.x/macros-attributes/storage">#[ink(storage)]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/6.x/macros-attributes/topic">#[ink(topic)]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/6.x/macros-attributes/chain-extension">#[ink::chain_extension]</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/6.x/datastructures/overview">Storage &amp; Data Structures</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/6.x/linter/overview">Linter</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/6.x/frontend/overview">Frontend Development</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/6.x/examples/smart-contracts">Examples</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/6.x/standards/overview">Standards</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/6.x/funding-programs">Funding Programs</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/6.x/getting-started/inkathon">Third Party Tools &amp; Libraries</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/6.x/faq">FAQ</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/6.x/brand-assets/ink">Brand Assets</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg id="prefix__Layer_1" xmlns="http://www.w3.org/2000/svg" x="0" y="0" viewBox="0 0 75 73.3" style="enable-background:new 0 0 75 73.3" xml:space="preserve" role="img" class="breadcrumbHomeIcon_YNFT"><style>.prefix__st0{opacity:.75}.prefix__st1{fill-rule:evenodd;clip-rule:evenodd;fill:#e3e3e3}.prefix__st2{fill:#fff}</style><g class="prefix__st0"><path class="prefix__st1" d="M6.9 47.1h2.4c8.8-26.7-22.6-20.4-2.4 0z"></path></g><g class="prefix__st0"><path class="prefix__st1" d="M6.9 49.1h2.4c8.8 26.7-22.6 20.4-2.4 0z"></path></g><g class="prefix__st0"><path class="prefix__st2" d="M12.2 50.6H5.1c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5h7.1c1.4 0 2.5 1.1 2.5 2.5s-1.1 2.5-2.5 2.5z"></path></g><g class="prefix__st0"><path class="prefix__st1" d="M37.4 19.7V5.9C37.4 2.7 40 0 43.3 0h11.9v10.7h-4.7c-1.2 0-2.2 1-2.2 2.2v6.7l-10.9.1z"></path></g><path d="m58.5 31.2-1.2-9.4c-.2-1.7-1.7-3-3.4-3H33.3c-1.7 0-3.2 1.3-3.4 3l-1.2 9.4h29.8z" style="fill-rule:evenodd;clip-rule:evenodd;fill:#fff" class="prefix__st0"></path><g class="prefix__st0"><path class="prefix__st1" d="M43.6 22.9c-17.4 0-31.4 11.3-31.4 25.2s14.1 25.2 31.4 25.2S75 62 75 48.1 60.9 22.9 43.6 22.9zm0 36.5c-6.6 0-11.9-5.3-11.9-11.9S37 35.6 43.6 35.6 55.5 41 55.5 47.5s-5.4 11.9-11.9 11.9z"></path></g><path d="M38 52.8c-.6 0-1.3-.2-1.8-.7-1-1-1-2.6 0-3.5l8.4-8.4c1-1 2.6-1 3.5 0 1 1 1 2.6 0 3.5l-8.4 8.4c-.4.5-1 .7-1.7.7z" style="fill:#e3e3e3" class="prefix__st0"></path><g class="prefix__st0"><path class="prefix__st2" d="M43.6 63.7c-8.9 0-16.2-7.3-16.2-16.2s7.3-16.2 16.2-16.2 16.2 7.3 16.2 16.2-7.3 16.2-16.2 16.2zm0-27.3c-6.2 0-11.2 5-11.2 11.2s5 11.2 11.2 11.2 11.2-5 11.2-11.2-5.1-11.2-11.2-11.2z"></path></g><g class="prefix__st0"><path class="prefix__st2" d="M52.8 0h5v10.7h-5z"></path></g></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Macros &amp; Attributes</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">#[ink::chain_extension]</span><meta itemprop="position" content="2"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: 6.x</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><img src="/img/title/text/chain-ext.svg" class="titlePic">
<p>In the default configuration of the <code>contracts-pallet</code> a smart contract can only interact with the runtime
via its well defined set of basic smart contract interface functions. This API already allows a whole variety of
interaction between the <code>contracts-pallet</code> and the executed smart contract. For example it is possible
to call and instantiate other smart contracts on the same chain, emit events, query context information
or run built-in cryptographic hashing procedures.</p>
<p>If this basic set of features is not enough for a particular Substrate built blockchain it is possible
to easily extend this API using the so-called chain extension feature.</p>
<center><img src="/img/venn.png" width="50%"></center>
<p>With chain extensions you can expose parts of your runtime logic
to smart contract developers.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 75 75"><style>.st1{fill:#bc83fb}.st4{fill:#d8b7fb}</style><ellipse cx="37.5" cy="37.5" rx="38.92" ry="36.03" style="fill:#fff" transform="rotate(-45.001 37.501 37.497)"></ellipse><path d="M34.56 50.4s3.56 4.75 9.4-1.47c3.71-3.94 6.78-4.02 7.19-1.17.51 3.54-5.11 12.97-13.43 12.97z" class="st1"></path><path d="M37.5 66.74c-15.46 0-28.04-12.58-28.04-28.04 0-9.82 5-18.76 13.38-23.91.89-.55 2.05-.27 2.59.62.55.89.27 2.05-.62 2.59-7.25 4.46-11.58 12.19-11.58 20.7 0 13.38 10.89 24.27 24.27 24.27S61.77 52.08 61.77 38.7c0-8.5-4.33-16.24-11.58-20.69a1.886 1.886 0 0 1-.62-2.59c.55-.89 1.71-1.16 2.59-.62 8.38 5.15 13.38 14.09 13.38 23.91 0 15.44-12.58 28.03-28.04 28.03" class="st1"></path><path d="M37.5 60.73c-3.55 0-6.46-2.91-6.46-6.46V29.56c0-3.55 2.91-6.46 6.46-6.46s6.46 2.91 6.46 6.46v24.71c0 3.55-2.91 6.46-6.46 6.46" style="fill:#8747cc"></path><ellipse cx="37.49" cy="13.82" rx="5.51" ry="6.18" style="fill-rule:evenodd;clip-rule:evenodd;fill:#bc83fb" transform="rotate(-76.761 37.496 13.816)"></ellipse><ellipse cx="37.25" cy="51.86" class="st4" rx="3.54" ry="2.4" transform="rotate(-84.393 37.253 51.863)"></ellipse><ellipse cx="37.25" cy="39.35" class="st4" rx="4.39" ry="2.97" transform="rotate(-84.393 37.25 39.353)"></ellipse><path d="M43.96 29.55v7.86c0-4.78-2.03-7.84-5.29-7.75-2.38.06-5.25 3.51-7.63 6.05-3.7 3.95-6.78 3.22-7.18.37-.5-3.47 5.11-12.6 13.17-12.95.15-.01.31-.02.46-.02h.02c3.55 0 6.45 2.89 6.45 6.44" class="st1"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>The ink! examples repository contains <a href="https://github.com/use-ink/ink-examples/tree/main/rand-extension" target="_blank" rel="noopener noreferrer">the <code>rand-extension</code> example</a>.
This is a complete example of a chain extension implemented in both ink! and Substrate.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="structure">Structure<a href="#structure" class="hash-link" aria-label="Direct link to Structure" title="Direct link to Structure">​</a></h2>
<p>The interface consists of an error code that indicates lightweight errors
as well as the definition of some chain extension methods.</p>
<p>The overall structure follows that of a simple Rust trait definition.
The error code is defined as an associated type definition of the trait definition.
The methods are defined as associated trait methods without implementation.</p>
<p>Chain extension methods must not have a <code>self</code> receiver such as <code>&amp;self</code> or <code>&amp;mut self</code>
and must have inputs and output that implement SCALE codec. Their return value follows
specific rules that can be altered using the <code>handle_status</code> attribute and
alternation between  <code>Result</code> and Non-<code>Result</code> types which are described in more detail below.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="usage">Usage<a href="#usage" class="hash-link" aria-label="Direct link to Usage" title="Direct link to Usage">​</a></h2>
<p>Usually the chain extension definition using this proc. macro is provided
by the author of the chain extension in a separate crate.
ink! smart contracts using this chain extension simply depend on this crate
and use its associated environment definition in order to make use of
the methods provided by the chain extension.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="macro-attributes">Macro Attributes<a href="#macro-attributes" class="hash-link" aria-label="Direct link to Macro Attributes" title="Direct link to Macro Attributes">​</a></h2>
<p>The macro supports only one required argument: <code>extension = N: u16</code>.
The runtime may have several chain extensions at the same time. The <code>extension</code>
identifier points to the corresponding chain extension in the runtime.
The value should be the same as during the definition of the chain extension.
You can consult the
<a href="https://paritytech.github.io/polkadot-sdk/master/pallet_contracts/chain_extension/index.html" target="_blank" rel="noopener noreferrer">chain extension module documentation</a>
if you are unsure how to find the chain extension code.
Otherwise, you should consult the target chain&#x27;s documentation
for specifications of any chain extensions it exposes.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 75 75"><style>.st1{fill:#bc83fb}.st4{fill:#d8b7fb}</style><ellipse cx="37.5" cy="37.5" rx="38.92" ry="36.03" style="fill:#fff" transform="rotate(-45.001 37.501 37.497)"></ellipse><path d="M34.56 50.4s3.56 4.75 9.4-1.47c3.71-3.94 6.78-4.02 7.19-1.17.51 3.54-5.11 12.97-13.43 12.97z" class="st1"></path><path d="M37.5 66.74c-15.46 0-28.04-12.58-28.04-28.04 0-9.82 5-18.76 13.38-23.91.89-.55 2.05-.27 2.59.62.55.89.27 2.05-.62 2.59-7.25 4.46-11.58 12.19-11.58 20.7 0 13.38 10.89 24.27 24.27 24.27S61.77 52.08 61.77 38.7c0-8.5-4.33-16.24-11.58-20.69a1.886 1.886 0 0 1-.62-2.59c.55-.89 1.71-1.16 2.59-.62 8.38 5.15 13.38 14.09 13.38 23.91 0 15.44-12.58 28.03-28.04 28.03" class="st1"></path><path d="M37.5 60.73c-3.55 0-6.46-2.91-6.46-6.46V29.56c0-3.55 2.91-6.46 6.46-6.46s6.46 2.91 6.46 6.46v24.71c0 3.55-2.91 6.46-6.46 6.46" style="fill:#8747cc"></path><ellipse cx="37.49" cy="13.82" rx="5.51" ry="6.18" style="fill-rule:evenodd;clip-rule:evenodd;fill:#bc83fb" transform="rotate(-76.761 37.496 13.816)"></ellipse><ellipse cx="37.25" cy="51.86" class="st4" rx="3.54" ry="2.4" transform="rotate(-84.393 37.253 51.863)"></ellipse><ellipse cx="37.25" cy="39.35" class="st4" rx="4.39" ry="2.97" transform="rotate(-84.393 37.25 39.353)"></ellipse><path d="M43.96 29.55v7.86c0-4.78-2.03-7.84-5.29-7.75-2.38.06-5.25 3.51-7.63 6.05-3.7 3.95-6.78 3.22-7.18.37-.5-3.47 5.11-12.6 13.17-12.95.15-.01.31-.02.46-.02h.02c3.55 0 6.45 2.89 6.45 6.44" class="st1"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>If the chain extension is not used in a tuple in the runtime configuration,
<code>extension = N: u16</code> can take any <code>u16</code> number.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="method-attributes">Method Attributes<a href="#method-attributes" class="hash-link" aria-label="Direct link to Method Attributes" title="Direct link to Method Attributes">​</a></h2>
<p>There are two different attributes with which the chain extension methods
can be flagged:</p>
<table><thead><tr><th style="text-align:left">Attribute</th><th style="text-align:center">Required</th><th style="text-align:left">Default Value</th><th style="text-align:center">Description</th></tr></thead><tbody><tr><td style="text-align:left"><code>ink(function = N: u16)</code></td><td style="text-align:center">Yes</td><td style="text-align:left">-</td><td style="text-align:center">Determines the unique function ID within the chain extension.</td></tr><tr><td style="text-align:left"><code>ink(handle_status = flag: bool)</code></td><td style="text-align:center">Optional</td><td style="text-align:left"><code>true</code></td><td style="text-align:center">Assumes that the returned status code of the chain extension method always indicates success and therefore always loads and decodes the output buffer of the call.</td></tr></tbody></table>
<p>As with all ink! attributes multiple of them can either appear in a contiguous list:</p>
<div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token keyword" style="color:#ffcc99">type</span><span class="token plain"> </span><span class="token type-definition class-name">Access</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">i32</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink::chain_extension(extension = 12)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">trait</span><span class="token plain"> </span><span class="token type-definition class-name">MyChainExtension</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">type</span><span class="token plain"> </span><span class="token type-definition class-name">ErrorCode</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">i32</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink(function = 5, handle_status = false)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">key_access_for_account</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&amp;</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> account</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&amp;</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">-&gt;</span><span class="token plain"> </span><span class="token class-name">Access</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>…or as multiple standalone ink! attributes applied to the same item:</p>
<div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token keyword" style="color:#ffcc99">type</span><span class="token plain"> </span><span class="token type-definition class-name">Access</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">i32</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink::chain_extension(extension = 12)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">trait</span><span class="token plain"> </span><span class="token type-definition class-name">MyChainExtension</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token keyword" style="color:#ffcc99">type</span><span class="token plain"> </span><span class="token type-definition class-name">ErrorCode</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">i32</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink(function = 5)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink(handle_status = false)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">key_access_for_account</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&amp;</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> account</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&amp;</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">-&gt;</span><span class="token plain"> </span><span class="token class-name">Access</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="details-handle_status">Details: <code>handle_status</code><a href="#details-handle_status" class="hash-link" aria-label="Direct link to details-handle_status" title="Direct link to details-handle_status">​</a></h2>
<p>Default value: <code>true</code></p>
<p>By default all chain extension methods should return a <code>Result&lt;T, E&gt;</code> where <code>E: From&lt;Self::ErrorCode&gt;</code>.
The <code>Self::ErrorCode</code> represents the error code of the chain extension.
This means that a smart contract calling such a chain extension method first queries the returned
status code of the chain extension method and only loads and decodes the output if the returned
status code indicates a successful call.
This design was chosen as it is more efficient when no output besides the error
code is required for a chain extension call. When designing a chain extension try to utilize the
error code to return errors and only use the output buffer for information that does not fit in
a single <code>u32</code> value.</p>
<p>A chain extension method that is flagged with <code>handle_status = false</code> assumes that the returned error code
will always indicate success. Therefore it will always load and decode the output buffer and loses
the <code>E: From&lt;Self::ErrorCode</code> constraint for the call.</p>
<p>Note that if a chain extension method does not return <code>Result&lt;T, E&gt;</code> where <code>E: From&lt;Self::ErrorCode&gt;</code>,
but <code>handle_status = true</code> it will still return a value of type <code>Result&lt;T, Self::ErrorCode&gt;</code>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="usage-handle_status--resultt-e-return-type">Usage: <code>handle_status</code> + <code>Result&lt;T, E&gt;</code> return type<a href="#usage-handle_status--resultt-e-return-type" class="hash-link" aria-label="Direct link to usage-handle_status--resultt-e-return-type" title="Direct link to usage-handle_status--resultt-e-return-type">​</a></h2>
<p>Use both <code>handle_status = false</code> and non-<code>Result</code> return type for the same chain extension method
if a call to it may never fail and never returns a <code>Result</code> type.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="combinations">Combinations<a href="#combinations" class="hash-link" aria-label="Direct link to Combinations" title="Direct link to Combinations">​</a></h2>
<p>Due to the possibility to flag a chain extension method with <code>handle_status</code> and either (1) return <code>Result&lt;T, E&gt;</code>
or (2) return just <code>T</code>
there are 4 different cases with slightly varying semantics:</p>
<table><thead><tr><th style="text-align:center"><code>handle_status</code></th><th style="text-align:center">Returns <code>Result&lt;T, E&gt;</code></th><th style="text-align:left">Effects</th></tr></thead><tbody><tr><td style="text-align:center"><code>true</code></td><td style="text-align:center"><code>true</code></td><td style="text-align:left">The chain extension method is required to return a value of type <code>Result&lt;T, E&gt;</code> where <code>E: From&lt;Self::ErrorCode&gt;</code>. A call will always check if the returned status code indicates success and only then will load and decode the value in the output buffer.</td></tr><tr><td style="text-align:center"><code>true</code></td><td style="text-align:center"><code>false</code></td><td style="text-align:left">The chain extension method may return any non-<code>Result</code> type. A call will always check if the returned status code indicates success and only then will load and decode the value in the output buffer. The actual return type of the chain extension method is still <code>Result&lt;T, Self::ErrorCode&gt;</code> when the chain extension method was defined to return a value of type <code>T</code>.</td></tr><tr><td style="text-align:center"><code>false</code></td><td style="text-align:center"><code>true</code></td><td style="text-align:left">The chain extension method is required to return a value of type <code>Result&lt;T, E&gt;</code>. A call will always assume that the returned status code indicates success and therefore always load and decode the output buffer directly.</td></tr><tr><td style="text-align:center"><code>false</code></td><td style="text-align:center"><code>false</code></td><td style="text-align:left">The chain extension method may return any non-<code>Result</code> type. A call will always assume that the returned status code indicates success and therefore always load and decode the output buffer directly.</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="error-code">Error Code<a href="#error-code" class="hash-link" aria-label="Direct link to Error Code" title="Direct link to Error Code">​</a></h2>
<p>Every chain extension defines exactly one <code>ErrorCode</code> using the following syntax:</p>
<div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token attribute attr-name" style="color:#c4b9fe">#[ink::chain_extension]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">trait</span><span class="token plain"> </span><span class="token type-definition class-name">MyChainExtension</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">type</span><span class="token plain"> </span><span class="token type-definition class-name">ErrorCode</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token class-name">MyErrorCode</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// more definitions ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The defined <code>ErrorCode</code> must implement <code>FromStatusCode</code> which should be implemented as a
more or less trivial conversion from the <code>u32</code> status code to a <code>Result&lt;(), Self::ErrorCode&gt;</code>.
The <code>Ok(())</code> value indicates that the call to the chain extension method was successful.</p>
<p>By convention an error code of <code>0</code> represents success.
However, chain extension authors may use whatever suits their needs.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="example-definition">Example: Definition<a href="#example-definition" class="hash-link" aria-label="Direct link to Example: Definition" title="Direct link to Example: Definition">​</a></h2>
<p>In the below example a chain extension is defined that allows its users to read and write
from and to the runtime storage using access privileges:</p>
<div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token comment" style="color:#6c6783">/// Custom chain extension to read to and write from the runtime.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink::chain_extension(extension = 12)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">trait</span><span class="token plain"> </span><span class="token type-definition class-name">RuntimeReadWrite</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">type</span><span class="token plain"> </span><span class="token type-definition class-name">ErrorCode</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token class-name">ReadWriteErrorCode</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// Reads from runtime storage.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// # Note</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// Actually returns a value of type `Result&lt;Vec&lt;u8&gt;, Self::ErrorCode&gt;`.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink(function = 1, returns_result = false)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">read</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&amp;</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">-&gt;</span><span class="token plain"> </span><span class="token class-name">Vec</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// Reads from runtime storage.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// Returns the number of bytes read and up to 32 bytes of the</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// read value. Unused bytes in the output are set to 0.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// # Errors</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// If the runtime storage cell stores a value that requires more than</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// 32 bytes.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// # Note</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// This requires `ReadWriteError` to implement `From&lt;ReadWriteErrorCode&gt;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// and may potentially return any `Self::ErrorCode` through its return value.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink(function = 2)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">read_small</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&amp;</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">-&gt;</span><span class="token plain"> </span><span class="token class-name">Result</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token keyword" style="color:#ffcc99">u32</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">[</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"> </span><span class="token number" style="color:#e09142">32</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token class-name">ReadWriteError</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// Writes into runtime storage.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// # Note</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// Actually returns a value of type `Result&lt;(), Self::ErrorCode&gt;`.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink(function = 3)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">write</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&amp;</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> value</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&amp;</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// Returns the access allowed for the key for the caller.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// # Note</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// Assumes to never fail the call and therefore always returns `Option&lt;Access&gt;`.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink(function = 4, handle_status = false)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">access</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&amp;</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">-&gt;</span><span class="token plain"> </span><span class="token class-name">Option</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token class-name">Access</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// Unlocks previously acquired permission to access key.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// # Errors</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// If the permission was not granted.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// # Note</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// Assumes the call to never fail and therefore does _NOT_ require `UnlockAccessError`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// to implement `From&lt;Self::ErrorCode&gt;` as in the `read_small` method above.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink(function = 5, handle_status = false)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">unlock_access</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&amp;</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> access</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token class-name">Access</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">-&gt;</span><span class="token plain"> </span><span class="token class-name">Result</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token class-name">UnlockAccessError</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink::scale_derive(Encode, Decode, TypeInfo)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">enum</span><span class="token plain"> </span><span class="token type-definition class-name">ReadWriteErrorCode</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token class-name">InvalidKey</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token class-name">CannotWriteToKey</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token class-name">CannotReadFromKey</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink::scale_derive(Encode, Decode, TypeInfo)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">enum</span><span class="token plain"> </span><span class="token type-definition class-name">ReadWriteError</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token class-name">ErrorCode</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name">ReadWriteErrorCode</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token class-name">BufferTooSmall</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"> required_bytes</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">u32</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">impl</span><span class="token plain"> </span><span class="token class-name">From</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token class-name">ReadWriteErrorCode</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">for</span><span class="token plain"> </span><span class="token class-name">ReadWriteError</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">from</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">error_code</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token class-name">ReadWriteErrorCode</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">Self</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">Self</span><span class="token punctuation" style="color:#6c6783">::</span><span class="token class-name">ErrorCode</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">error_code</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">impl</span><span class="token plain"> </span><span class="token class-name">From</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token namespace" style="opacity:0.7">scale</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token class-name">Error</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">for</span><span class="token plain"> </span><span class="token class-name">ReadWriteError</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">from</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">_</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">scale</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token class-name">Error</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">Self</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token macro property" style="color:#9a86fd">panic!</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token string" style="color:#ffcc99">&quot;encountered unexpected invalid SCALE encoding&quot;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink::scale_derive(Encode, Decode, TypeInfo)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">struct</span><span class="token plain"> </span><span class="token type-definition class-name">UnlockAccessError</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  reason</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token class-name">String</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">impl</span><span class="token plain"> </span><span class="token class-name">From</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token namespace" style="opacity:0.7">scale</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token class-name">Error</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">for</span><span class="token plain"> </span><span class="token class-name">UnlockAccessError</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">from</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">_</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">scale</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token class-name">Error</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">Self</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token macro property" style="color:#9a86fd">panic!</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token string" style="color:#ffcc99">&quot;encountered unexpected invalid SCALE encoding&quot;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink::scale_derive(Encode, Decode, TypeInfo)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">enum</span><span class="token plain"> </span><span class="token type-definition class-name">Access</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token class-name">ReadWrite</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token class-name">ReadOnly</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token class-name">WriteOnly</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">impl</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">ink</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token namespace" style="opacity:0.7">env</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token namespace" style="opacity:0.7">chain_extension</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token class-name">FromStatusCode</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">for</span><span class="token plain"> </span><span class="token class-name">ReadWriteErrorCode</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">from_status_code</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">status_code</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">u32</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">-&gt;</span><span class="token plain"> </span><span class="token class-name">Result</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">Self</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">match</span><span class="token plain"> status_code </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">      </span><span class="token number" style="color:#e09142">0</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=&gt;</span><span class="token plain"> </span><span class="token class-name">Ok</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">      </span><span class="token number" style="color:#e09142">1</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=&gt;</span><span class="token plain"> </span><span class="token class-name">Err</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token keyword" style="color:#ffcc99">Self</span><span class="token punctuation" style="color:#6c6783">::</span><span class="token class-name">InvalidKey</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">      </span><span class="token number" style="color:#e09142">2</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=&gt;</span><span class="token plain"> </span><span class="token class-name">Err</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token keyword" style="color:#ffcc99">Self</span><span class="token punctuation" style="color:#6c6783">::</span><span class="token class-name">CannotWriteToKey</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">      </span><span class="token number" style="color:#e09142">3</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=&gt;</span><span class="token plain"> </span><span class="token class-name">Err</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token keyword" style="color:#ffcc99">Self</span><span class="token punctuation" style="color:#6c6783">::</span><span class="token class-name">CannotReadFromKey</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">      _ </span><span class="token operator" style="color:#e09142">=&gt;</span><span class="token plain"> </span><span class="token macro property" style="color:#9a86fd">panic!</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token string" style="color:#ffcc99">&quot;encountered unknown status code&quot;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>All the error types and other utility types used in the chain extension definition
above are often required to implement various traits such as SCALE&#x27;s <code>Encode</code> and <code>Decode</code>
as well as <code>scale-info</code>&#x27;s <code>TypeInfo</code> trait.</p>
<p>A full example of the above chain extension definition can be seen
<a href="https://github.com/use-ink/ink/blob/017f71d60799b764425334f86b732cc7b7065fe6/crates/lang/macro/tests/ui/chain_extension/simple.rs" target="_blank" rel="noopener noreferrer">here</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="example-environment">Example: Environment<a href="#example-environment" class="hash-link" aria-label="Direct link to Example: Environment" title="Direct link to Example: Environment">​</a></h2>
<p>In order to allow ink! smart contracts to use the above defined chain extension it needs
to be integrated into an <code>Environment</code> definition as shown below:</p>
<div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token keyword" style="color:#ffcc99">type</span><span class="token plain"> </span><span class="token type-definition class-name">RuntimeReadWrite</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">i32</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">use</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">ink</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token namespace" style="opacity:0.7">env</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token punctuation" style="color:#6c6783">{</span><span class="token class-name">Environment</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token class-name">DefaultEnvironment</span><span class="token punctuation" style="color:#6c6783">}</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">enum</span><span class="token plain"> </span><span class="token type-definition class-name">CustomEnvironment</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">impl</span><span class="token plain"> </span><span class="token class-name">Environment</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">for</span><span class="token plain"> </span><span class="token class-name">CustomEnvironment</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">const</span><span class="token plain"> </span><span class="token constant">MAX_EVENT_TOPICS</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">usize</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token operator" style="color:#e09142">&lt;</span><span class="token class-name">DefaultEnvironment</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">as</span><span class="token plain"> </span><span class="token class-name">Environment</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">::</span><span class="token constant">MAX_EVENT_TOPICS</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">type</span><span class="token plain"> </span><span class="token type-definition class-name">AccountId</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&lt;</span><span class="token class-name">DefaultEnvironment</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">as</span><span class="token plain"> </span><span class="token class-name">Environment</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">::</span><span class="token class-name">AccountId</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">type</span><span class="token plain"> </span><span class="token type-definition class-name">Balance</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&lt;</span><span class="token class-name">DefaultEnvironment</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">as</span><span class="token plain"> </span><span class="token class-name">Environment</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">::</span><span class="token class-name">Balance</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">type</span><span class="token plain"> </span><span class="token type-definition class-name">Hash</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&lt;</span><span class="token class-name">DefaultEnvironment</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">as</span><span class="token plain"> </span><span class="token class-name">Environment</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">::</span><span class="token class-name">Hash</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">type</span><span class="token plain"> </span><span class="token type-definition class-name">BlockNumber</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&lt;</span><span class="token class-name">DefaultEnvironment</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">as</span><span class="token plain"> </span><span class="token class-name">Environment</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">::</span><span class="token class-name">BlockNumber</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">type</span><span class="token plain"> </span><span class="token type-definition class-name">Timestamp</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&lt;</span><span class="token class-name">DefaultEnvironment</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">as</span><span class="token plain"> </span><span class="token class-name">Environment</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">::</span><span class="token class-name">Timestamp</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">type</span><span class="token plain"> </span><span class="token type-definition class-name">ChainExtension</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token class-name">RuntimeReadWrite</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Above we defined the <code>CustomEnvironment</code> which defaults to ink!&#x27;s <code>DefaultEnvironment</code>
for all constants and types but the <code>ChainExtension</code> type which is assigned to our newly
defined chain extension.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="example-usage">Example: Usage<a href="#example-usage" class="hash-link" aria-label="Direct link to Example: Usage" title="Direct link to Example: Usage">​</a></h2>
<p>An ink! smart contract can use the above defined chain extension through the <code>Environment</code>
definition defined in the last example section using the <code>env</code> macro parameter as
shown below.</p>
<p>Note that chain extension methods are accessible through <code>Self::extension()</code> or
<code>self.extension()</code>. For example as in <code>Self::extension().read(..)</code> or <code>self.extension().read(..)</code>.</p>
<div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token attribute attr-name" style="color:#c4b9fe">#[ink::contract(env = CustomEnvironment)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">mod</span><span class="token plain"> </span><span class="token module-declaration namespace" style="opacity:0.7">read_writer</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink(storage)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">struct</span><span class="token plain"> </span><span class="token type-definition class-name">ReadWriter</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">impl</span><span class="token plain"> </span><span class="token class-name">ReadWriter</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink(constructor)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">new</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">Self</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">Self</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink(message)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">read</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token operator" style="color:#e09142">&amp;</span><span class="token keyword" style="color:#ffcc99">self</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> key</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token class-name">Vec</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">-&gt;</span><span class="token plain"> </span><span class="token class-name">Result</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token class-name">Vec</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token class-name">ReadWriteErrorCode</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token keyword" style="color:#ffcc99">self</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">env</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                </span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">extension</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                </span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">read</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token operator" style="color:#e09142">&amp;</span><span class="token plain">key</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink(message)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">read_small</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token operator" style="color:#e09142">&amp;</span><span class="token keyword" style="color:#ffcc99">self</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> key</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token class-name">Vec</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">-&gt;</span><span class="token plain"> </span><span class="token class-name">Result</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token keyword" style="color:#ffcc99">u32</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">[</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"> </span><span class="token number" style="color:#e09142">32</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token class-name">ReadWriteError</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token keyword" style="color:#ffcc99">self</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">env</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                </span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">extension</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                </span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">read_small</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token operator" style="color:#e09142">&amp;</span><span class="token plain">key</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink(message)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">write</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token operator" style="color:#e09142">&amp;</span><span class="token keyword" style="color:#ffcc99">self</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            key</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token class-name">Vec</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            value</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token class-name">Vec</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">-&gt;</span><span class="token plain"> </span><span class="token class-name">Result</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token class-name">ReadWriteErrorCode</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token keyword" style="color:#ffcc99">self</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">env</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                </span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">extension</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                </span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">write</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token operator" style="color:#e09142">&amp;</span><span class="token plain">key</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&amp;</span><span class="token plain">value</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink(message)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">access</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token operator" style="color:#e09142">&amp;</span><span class="token keyword" style="color:#ffcc99">self</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> key</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token class-name">Vec</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">-&gt;</span><span class="token plain"> </span><span class="token class-name">Option</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token class-name">Access</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token keyword" style="color:#ffcc99">self</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">env</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                </span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">extension</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                </span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">access</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token operator" style="color:#e09142">&amp;</span><span class="token plain">key</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink(message)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">unlock_access</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token operator" style="color:#e09142">&amp;</span><span class="token keyword" style="color:#ffcc99">self</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> key</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token class-name">Vec</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> access</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token class-name">Access</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">-&gt;</span><span class="token plain"> </span><span class="token class-name">Result</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token class-name">UnlockAccessError</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token keyword" style="color:#ffcc99">self</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">env</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                </span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">extension</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                </span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">unlock_access</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token operator" style="color:#e09142">&amp;</span><span class="token plain">key</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> access</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// Custom chain extension to read to and write from the runtime.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink::chain_extension(extension = 12)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">trait</span><span class="token plain"> </span><span class="token type-definition class-name">RuntimeReadWrite</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">          </span><span class="token keyword" style="color:#ffcc99">type</span><span class="token plain"> </span><span class="token type-definition class-name">ErrorCode</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token class-name">ReadWriteErrorCode</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">          </span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink(function = 1)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">          </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">read</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&amp;</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">-&gt;</span><span class="token plain"> </span><span class="token class-name">Vec</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">          </span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink(function = 2)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">          </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">read_small</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&amp;</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">-&gt;</span><span class="token plain"> </span><span class="token class-name">Result</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token keyword" style="color:#ffcc99">u32</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">[</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"> </span><span class="token number" style="color:#e09142">32</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token class-name">ReadWriteError</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">          </span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink(function = 3)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">          </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">write</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&amp;</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> value</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&amp;</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">          </span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink(function = 4, handle_status = false)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">          </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">access</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&amp;</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">-&gt;</span><span class="token plain"> </span><span class="token class-name">Option</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token class-name">Access</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">          </span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink(function = 5, handle_status = false)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">          </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">unlock_access</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&amp;</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> access</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token class-name">Access</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">-&gt;</span><span class="token plain"> </span><span class="token class-name">Result</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token class-name">UnlockAccessError</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink::scale_derive(Encode, Decode, TypeInfo)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">enum</span><span class="token plain"> </span><span class="token type-definition class-name">ReadWriteErrorCode</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">          </span><span class="token class-name">InvalidKey</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">          </span><span class="token class-name">CannotWriteToKey</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">          </span><span class="token class-name">CannotReadFromKey</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink::scale_derive(Encode, Decode, TypeInfo)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">enum</span><span class="token plain"> </span><span class="token type-definition class-name">ReadWriteError</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">          </span><span class="token class-name">ErrorCode</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name">ReadWriteErrorCode</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">          </span><span class="token class-name">BufferTooSmall</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"> required_bytes</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">u32</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">impl</span><span class="token plain"> </span><span class="token class-name">From</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token class-name">ReadWriteErrorCode</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">for</span><span class="token plain"> </span><span class="token class-name">ReadWriteError</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">         </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">from</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">error_code</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token class-name">ReadWriteErrorCode</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">Self</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">             </span><span class="token keyword" style="color:#ffcc99">Self</span><span class="token punctuation" style="color:#6c6783">::</span><span class="token class-name">ErrorCode</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">error_code</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">         </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">impl</span><span class="token plain"> </span><span class="token class-name">From</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token namespace" style="opacity:0.7">scale</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token class-name">Error</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">for</span><span class="token plain"> </span><span class="token class-name">ReadWriteError</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">         </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">from</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">_</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">scale</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token class-name">Error</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">Self</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">             </span><span class="token macro property" style="color:#9a86fd">panic!</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token string" style="color:#ffcc99">&quot;encountered unexpected invalid SCALE encoding&quot;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">         </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink::scale_derive(Encode, Decode, TypeInfo)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">struct</span><span class="token plain"> </span><span class="token type-definition class-name">UnlockAccessError</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">         reason</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token class-name">String</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">impl</span><span class="token plain"> </span><span class="token class-name">From</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token namespace" style="opacity:0.7">scale</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token class-name">Error</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">for</span><span class="token plain"> </span><span class="token class-name">UnlockAccessError</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">         </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">from</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">_</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">scale</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token class-name">Error</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">Self</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">             </span><span class="token macro property" style="color:#9a86fd">panic!</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token string" style="color:#ffcc99">&quot;encountered unexpected invalid SCALE encoding&quot;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">         </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink::scale_derive(Encode, Decode, TypeInfo)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">enum</span><span class="token plain"> </span><span class="token type-definition class-name">Access</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">         </span><span class="token class-name">ReadWrite</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">         </span><span class="token class-name">ReadOnly</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">         </span><span class="token class-name">WriteOnly</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">impl</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">ink</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token namespace" style="opacity:0.7">env</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token namespace" style="opacity:0.7">chain_extension</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token class-name">FromStatusCode</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">for</span><span class="token plain"> </span><span class="token class-name">ReadWriteErrorCode</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">         </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">from_status_code</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">status_code</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">u32</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">-&gt;</span><span class="token plain"> </span><span class="token class-name">Result</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">Self</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">             </span><span class="token keyword" style="color:#ffcc99">match</span><span class="token plain"> status_code </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                 </span><span class="token number" style="color:#e09142">0</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=&gt;</span><span class="token plain"> </span><span class="token class-name">Ok</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                 </span><span class="token number" style="color:#e09142">1</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=&gt;</span><span class="token plain"> </span><span class="token class-name">Err</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token keyword" style="color:#ffcc99">Self</span><span class="token punctuation" style="color:#6c6783">::</span><span class="token class-name">InvalidKey</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                 </span><span class="token number" style="color:#e09142">2</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=&gt;</span><span class="token plain"> </span><span class="token class-name">Err</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token keyword" style="color:#ffcc99">Self</span><span class="token punctuation" style="color:#6c6783">::</span><span class="token class-name">CannotWriteToKey</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                 </span><span class="token number" style="color:#e09142">3</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=&gt;</span><span class="token plain"> </span><span class="token class-name">Err</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token keyword" style="color:#ffcc99">Self</span><span class="token punctuation" style="color:#6c6783">::</span><span class="token class-name">CannotReadFromKey</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                 _ </span><span class="token operator" style="color:#e09142">=&gt;</span><span class="token plain"> </span><span class="token macro property" style="color:#9a86fd">panic!</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token string" style="color:#ffcc99">&quot;encountered unknown status code&quot;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">             </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">         </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">enum</span><span class="token plain"> </span><span class="token type-definition class-name">CustomEnvironment</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">impl</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">ink</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token namespace" style="opacity:0.7">env</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token class-name">Environment</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">for</span><span class="token plain"> </span><span class="token class-name">CustomEnvironment</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">         </span><span class="token keyword" style="color:#ffcc99">const</span><span class="token plain"> </span><span class="token constant">MAX_EVENT_TOPICS</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">usize</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">             </span><span class="token operator" style="color:#e09142">&lt;</span><span class="token namespace" style="opacity:0.7">ink</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token namespace" style="opacity:0.7">env</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token class-name">DefaultEnvironment</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">as</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">ink</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token namespace" style="opacity:0.7">env</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token class-name">Environment</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">::</span><span class="token constant">MAX_EVENT_TOPICS</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">         </span><span class="token keyword" style="color:#ffcc99">type</span><span class="token plain"> </span><span class="token type-definition class-name">AccountId</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&lt;</span><span class="token namespace" style="opacity:0.7">ink</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token namespace" style="opacity:0.7">env</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token class-name">DefaultEnvironment</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">as</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">ink</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token namespace" style="opacity:0.7">env</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token class-name">Environment</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">::</span><span class="token class-name">AccountId</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">         </span><span class="token keyword" style="color:#ffcc99">type</span><span class="token plain"> </span><span class="token type-definition class-name">Balance</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&lt;</span><span class="token namespace" style="opacity:0.7">ink</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token namespace" style="opacity:0.7">env</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token class-name">DefaultEnvironment</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">as</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">ink</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token namespace" style="opacity:0.7">env</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token class-name">Environment</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">::</span><span class="token class-name">Balance</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">         </span><span class="token keyword" style="color:#ffcc99">type</span><span class="token plain"> </span><span class="token type-definition class-name">Hash</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&lt;</span><span class="token namespace" style="opacity:0.7">ink</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token namespace" style="opacity:0.7">env</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token class-name">DefaultEnvironment</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">as</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">ink</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token namespace" style="opacity:0.7">env</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token class-name">Environment</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">::</span><span class="token class-name">Hash</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">         </span><span class="token keyword" style="color:#ffcc99">type</span><span class="token plain"> </span><span class="token type-definition class-name">BlockNumber</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&lt;</span><span class="token namespace" style="opacity:0.7">ink</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token namespace" style="opacity:0.7">env</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token class-name">DefaultEnvironment</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">as</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">ink</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token namespace" style="opacity:0.7">env</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token class-name">Environment</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">::</span><span class="token class-name">BlockNumber</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">         </span><span class="token keyword" style="color:#ffcc99">type</span><span class="token plain"> </span><span class="token type-definition class-name">Timestamp</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&lt;</span><span class="token namespace" style="opacity:0.7">ink</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token namespace" style="opacity:0.7">env</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token class-name">DefaultEnvironment</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">as</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">ink</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token namespace" style="opacity:0.7">env</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token class-name">Environment</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">::</span><span class="token class-name">Timestamp</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">         </span><span class="token keyword" style="color:#ffcc99">type</span><span class="token plain"> </span><span class="token type-definition class-name">ChainExtension</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token class-name">RuntimeReadWrite</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="using-multiple-chain-extensions">Using Multiple Chain Extensions<a href="#using-multiple-chain-extensions" class="hash-link" aria-label="Direct link to Using Multiple Chain Extensions" title="Direct link to Using Multiple Chain Extensions">​</a></h2>
<p>It is possible to use multiple exposed chain extensions in the single environment of a smart contract.
The declaration procedure of the chain extension stays the same.</p>
<p>Suppose we want to combine two chain extension called <code>Psp22Extension</code> and <code>FetchRandom</code>, ink! provides
a useful macro <a href="https://docs.rs/ink/5.0.0/ink/macro.combine_extensions.html" target="_blank" rel="noopener noreferrer"><code>ink::combine_extensions!</code></a> that allows to construct the structure combining
the aforementioned chain extensions like so:</p>
<div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token namespace" style="opacity:0.7">ink</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token macro property" style="color:#9a86fd">combine_extensions!</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// This extension combines the `FetchRandom` and `Psp22Extension` extensions.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// It is possible to combine any number of extensions in this way.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// This structure is an instance that is returned by the `self.env().extension()` call.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">struct</span><span class="token plain"> </span><span class="token type-definition class-name">CombinedChainExtension</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">/// The instance of the `Psp22Extension` chain extension.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">/// It provides you access to `PSP22` functionality.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">pub</span><span class="token plain"> psp22</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token class-name">Psp22Extension</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">/// The instance of the `FetchRandom` chain extension.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">/// It provides you access to randomness functionality.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">pub</span><span class="token plain"> rand</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token class-name">FetchRandom</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The combined structure is called <code>CombinedChainExtension</code>, and we can refer to it
when specifying the chain extension type in <code>Environment</code>:</p>
<div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token keyword" style="color:#ffcc99">type</span><span class="token plain"> </span><span class="token type-definition class-name">ChainExtension</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token class-name">CombinedChainExtension</span><span class="token punctuation" style="color:#6c6783">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Each extension&#x27;s method can be called by accessing it via the name of the field of <code>CombineChainExtension</code>:</p>
<div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token keyword" style="color:#ffcc99">self</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">env</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">extension</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">rand</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token plain">method_name_in_rand_ext</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token comment" style="color:#6c6783">// or</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">self</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">env</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">extension</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">psp22</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token plain">method_name_in_psp22_ext</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token comment" style="color:#6c6783">// e.g.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">self</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">env</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">extension</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">psp22</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">total_supply</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 75 75"><style>.st1{fill:#bc83fb}.st4{fill:#d8b7fb}</style><ellipse cx="37.5" cy="37.5" rx="38.92" ry="36.03" style="fill:#fff" transform="rotate(-45.001 37.501 37.497)"></ellipse><path d="M34.56 50.4s3.56 4.75 9.4-1.47c3.71-3.94 6.78-4.02 7.19-1.17.51 3.54-5.11 12.97-13.43 12.97z" class="st1"></path><path d="M37.5 66.74c-15.46 0-28.04-12.58-28.04-28.04 0-9.82 5-18.76 13.38-23.91.89-.55 2.05-.27 2.59.62.55.89.27 2.05-.62 2.59-7.25 4.46-11.58 12.19-11.58 20.7 0 13.38 10.89 24.27 24.27 24.27S61.77 52.08 61.77 38.7c0-8.5-4.33-16.24-11.58-20.69a1.886 1.886 0 0 1-.62-2.59c.55-.89 1.71-1.16 2.59-.62 8.38 5.15 13.38 14.09 13.38 23.91 0 15.44-12.58 28.03-28.04 28.03" class="st1"></path><path d="M37.5 60.73c-3.55 0-6.46-2.91-6.46-6.46V29.56c0-3.55 2.91-6.46 6.46-6.46s6.46 2.91 6.46 6.46v24.71c0 3.55-2.91 6.46-6.46 6.46" style="fill:#8747cc"></path><ellipse cx="37.49" cy="13.82" rx="5.51" ry="6.18" style="fill-rule:evenodd;clip-rule:evenodd;fill:#bc83fb" transform="rotate(-76.761 37.496 13.816)"></ellipse><ellipse cx="37.25" cy="51.86" class="st4" rx="3.54" ry="2.4" transform="rotate(-84.393 37.253 51.863)"></ellipse><ellipse cx="37.25" cy="39.35" class="st4" rx="4.39" ry="2.97" transform="rotate(-84.393 37.25 39.353)"></ellipse><path d="M43.96 29.55v7.86c0-4.78-2.03-7.84-5.29-7.75-2.38.06-5.25 3.51-7.63 6.05-3.7 3.95-6.78 3.22-7.18.37-.5-3.47 5.11-12.6 13.17-12.95.15-.01.31-.02.46-.02h.02c3.55 0 6.45 2.89 6.45 6.44" class="st1"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>The ink! repository contains the <a href="https://github.com/use-ink/ink-examples/tree/main/combined-extension" target="_blank" rel="noopener noreferrer">full example</a> illustrating how to combine existing chain extensions
and mock them for testing.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="mocking-chain-extension">Mocking Chain Extension<a href="#mocking-chain-extension" class="hash-link" aria-label="Direct link to Mocking Chain Extension" title="Direct link to Mocking Chain Extension">​</a></h2>
<p>You can mock chain extensions for unit testing purposes.
This can be achieved by implementing the <a href="https://docs.rs/ink_env/5.0.0/ink_env/test/trait.ChainExtension.html" target="_blank" rel="noopener noreferrer"><code>ink::env::test::ChainExtension</code></a> trait.</p>
<div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token comment" style="color:#6c6783">/// Opaque structure</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">struct</span><span class="token plain"> </span><span class="token type-definition class-name">MockedPSP22Extension</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token comment" style="color:#6c6783">// Implementing </span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">impl</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">ink</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token namespace" style="opacity:0.7">env</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token namespace" style="opacity:0.7">test</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token class-name">ChainExtension</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">for</span><span class="token plain"> </span><span class="token class-name">MockedPSP22Extension</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">ext_id</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token operator" style="color:#e09142">&amp;</span><span class="token keyword" style="color:#ffcc99">self</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">u16</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">// It is identifier used by `psp22_extension::Psp22Extension` extension.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">// Must be the same as the once specified in `#[ink::chain_extension(extension = _)]`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token number" style="color:#e09142">13</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// Call dispatcher.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// Call specific code based on the function id which is dispatched from the contract/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">call</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token operator" style="color:#e09142">&amp;</span><span class="token keyword" style="color:#ffcc99">mut</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">self</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> func_id</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">u16</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> _input</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&amp;</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> output</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&amp;</span><span class="token keyword" style="color:#ffcc99">mut</span><span class="token plain"> </span><span class="token class-name">Vec</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">u32</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">match</span><span class="token plain"> func_id </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token comment" style="color:#6c6783">// `func_id` of the `total_supply` function.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token comment" style="color:#6c6783">// must match `#[ink(function = _)]` of the corresponding method</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token number" style="color:#e09142">0x162d</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                </span><span class="token namespace" style="opacity:0.7">ink</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token namespace" style="opacity:0.7">scale</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token class-name">Encode</span><span class="token punctuation" style="color:#6c6783">::</span><span class="token function" style="color:#9a86fd">encode_to</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token operator" style="color:#e09142">&amp;</span><span class="token constant">TOTAL_SUPPLY</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> output</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                </span><span class="token number" style="color:#e09142">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token comment" style="color:#6c6783">// Other functions</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            _ </span><span class="token operator" style="color:#e09142">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                </span><span class="token number" style="color:#e09142">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="technical-limitations">Technical Limitations<a href="#technical-limitations" class="hash-link" aria-label="Direct link to Technical Limitations" title="Direct link to Technical Limitations">​</a></h2>
<ul>
<li>Due to technical limitations it is not possible to refer to the <code>ErrorCode</code> associated type
using <code>Self::ErrorCode</code> anywhere within the chain extension and its defined methods.
Instead chain extension authors should directly use the error code type when required.
This limitation might be lifted in future versions of ink!.</li>
<li>It is not possible to declare other chain extension traits as super traits or super
chain extensions of another.</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/use-ink/ink-docs/edit/master/versioned_docs/version-6.x/macros-attributes/chain-extension.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/6.x/macros-attributes/topic"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">#[ink(topic)]</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/6.x/datastructures/overview"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Overview</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#structure" class="table-of-contents__link toc-highlight">Structure</a></li><li><a href="#usage" class="table-of-contents__link toc-highlight">Usage</a></li><li><a href="#macro-attributes" class="table-of-contents__link toc-highlight">Macro Attributes</a></li><li><a href="#method-attributes" class="table-of-contents__link toc-highlight">Method Attributes</a></li><li><a href="#details-handle_status" class="table-of-contents__link toc-highlight">Details: <code>handle_status</code></a></li><li><a href="#usage-handle_status--resultt-e-return-type" class="table-of-contents__link toc-highlight">Usage: <code>handle_status</code> + <code>Result&lt;T, E&gt;</code> return type</a></li><li><a href="#combinations" class="table-of-contents__link toc-highlight">Combinations</a></li><li><a href="#error-code" class="table-of-contents__link toc-highlight">Error Code</a></li><li><a href="#example-definition" class="table-of-contents__link toc-highlight">Example: Definition</a></li><li><a href="#example-environment" class="table-of-contents__link toc-highlight">Example: Environment</a></li><li><a href="#example-usage" class="table-of-contents__link toc-highlight">Example: Usage</a></li><li><a href="#using-multiple-chain-extensions" class="table-of-contents__link toc-highlight">Using Multiple Chain Extensions</a></li><li><a href="#mocking-chain-extension" class="table-of-contents__link toc-highlight">Mocking Chain Extension</a></li><li><a href="#technical-limitations" class="table-of-contents__link toc-highlight">Technical Limitations</a></li></ul></div></div></div></div></main></div></div></div></div>
</body>
</html>